<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Untitled</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S5 { line-height: 15.5926666259766px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S6 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S7 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S8 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S11 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S12 { margin-left: 3px; margin-top: 4px; margin-bottom: 4px; margin-right: 3px;  }
.S13 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S14 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S15 { min-height: 0px; font-family: monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { color: rgb(64, 64, 64); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
.outputGroup {margin: 2px 0 2px 0; padding: 2px 2px 2px 4px;}
.outputRegion {}
.outputParagraph {color: rgba(64, 64, 64, 1); padding: 10px 0 6px 17px; background: white; overflow-x: hidden;}
.inlineWrapper:last-child .outputParagraph {border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}
.outputParagraph:empty {margin: 0;}
.inlineElement .symbolicElement {margin-top: 1px; margin-bottom: 1px;}
.embeddedOutputsSymbolicElement .MathEquation {margin-top: 4px; margin-bottom: 4px;}
.embeddedOutputsSymbolicElement .MathEquation.displaySymbolicElement {margin-left: 15px;}
.embeddedOutputsSymbolicElement .MathEquation.inlineSymbolicElement {}
.embeddedOutputsSymbolicElement {overflow-x: auto; overflow-y: hidden;}
.embeddedOutputsSymbolicElement { overflow: initial !important;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement { max-height: none !important; overflow: initial !important;}
.veSpecifier {}
.veContainer {}
.veSpecifierBox {height: 400px; width: 500px;}
.veSpecifier .veTable {padding-top: 3px; padding-bottom: 4px;}
.veSpecifierBox .veSpecifier .veContainer {position: relative; width: 100%; height: 370px;}
.veSpecifierBox .dijitDialogPaneContent {width: 97% !important; height: 88% !important;}
.veSpecifier .veTable .rowHeadersWrapper {padding-bottom: 0;}
.veSpecifier .veTable .scroller .variableEditorRenderers {padding-right: 3px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;}
.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {visibility: hidden; z-index: 0;}
.veMetaSummary {font-style: italic;}
.veSpecifier .veTable .scroller {overflow: hidden;}
.veSpecifier .veTable:hover .scroller {overflow: auto;}
.veSpecifier .veVariableName,.veSpecifier .veDimensionFont {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.veSpecifier .veVariableName {padding-top: 2px;}
.veSpecifier .veDimensionFont {font-style: italic; color: #9A9A9A;}
.veSpecifier .scroller::-webkit-scrollbar-track {background-color: white;}
.veSpecifier .scroller::-webkit-scrollbar-corner {background-color: white;}
.veSpecifier .veTable .topRowHeaderWrapper {border: none; background-color: #F8F9FA;}
.veSpecifier .mw_type_ListBase.showCellBorders,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper,.veSpecifier .veTable .verticalScrollSpacer,.veSpecifier .veTable .horizontalScrollSpacer {border: none;}
.veSpecifier .veTable .dataScrollerNode {border: 1px solid #BFBFBF;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode,.veSpecifier .veTable .dataBody {font-family: Arial; font-size: 13px;}
.veSpecifier .veTable .columnHeaderNode,.veSpecifier .veTable .rowHeaderNode {color: #7F7F7F;}
.veSpecifier .veTable .dataBody {color: #000000;}
.veSpecifier .veTable .columnHeaderNode .cell .drag,.veSpecifier .veTable .columnHeaderNode .cell .header,.veSpecifier .veTable .topHeaderWrapper,.veSpecifier .veTable .bottomRowHeaderWrapper {background-color: #F8F9FA;}
.veSpecifier .veTable .columnHeaderNode .cell .dragBorder {border-right: 1px solid #F8F9FA;}
.veSpecifier .veTable .rowHeaderNode .cell {padding-top: 3px; text-align: center; border-bottom: 1px solid #F8F9FA;}
.veSpecifier .veTable .dataBody .cell .plainText {text-align: right;}
.veSpecifier .veTable .dataBody .row .cell {border-bottom: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.embeddedOutputsVariableElement {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; min-height: 18px; max-height: 250px; overflow: auto;}
.variableElement {}
.embeddedOutputsVariableElement.inlineElement {}
.inlineElement .variableElement {}
.variableNameElement {margin-bottom: 3px; display: inline-block;}
.variableValue { width: 100% !important; }
.embeddedOutputsMatrixElement {min-height: 18px; box-sizing: border-box; font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.embeddedOutputsMatrixElement .matrixElement,.rtcDataTipElement .matrixElement {position: relative;}
.matrixElement .variableValue,.rtcDataTipElement .matrixElement .variableValue {white-space: pre; display: inline-block; vertical-align: top; overflow: hidden;}
.embeddedOutputsMatrixElement.inlineElement {}
.embeddedOutputsMatrixElement.inlineElement .topHeaderWrapper {display: none;}
.embeddedOutputsMatrixElement.inlineElement .veTable .body {padding-top: 0 !important; max-height: 100px;}
.inlineElement .matrixElement {max-height: 300px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer,.rtcDataTipElement .matrixElement .valueContainer {white-space: nowrap; margin-bottom: 3px;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis.hide,.embeddedOutputsMatrixElement .matrixElement .verticalEllipsis.hide,.rtcDataTipElement .matrixElement .valueContainer .horizontalEllipsis.hide,.rtcDataTipElement .matrixElement .verticalEllipsis.hide {display: none;}
.embeddedOutputsMatrixElement .matrixElement .valueContainer .horizontalEllipsis {margin-bottom: -3px;}
.matrixElement { max-height: none !important; }
.dijitTooltipDialog .dijitTooltipContainer .dijitTooltipContents .alertPlugin-alertMessage {min-width: 12px; max-width: 400px; max-height: 300px; overflow: auto;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar {width: 11px; height: 11px;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-track {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-corner {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {border-radius: 7px; background-color: rgba(0, 0, 0, 0.1); border: 2px solid rgba(0, 0, 0, 0); background-clip: padding-box;}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.dijitTooltipDialog .alertPlugin-alertMessage::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb {background-color: rgba(0, 0, 0, 0.1);}
.dijitTooltipDialog .alertPlugin-alertMessage:hover::-webkit-scrollbar-thumb:hover {background-color: rgba(0, 0, 0, 0.2);}
.alertPlugin-alertLine {position: absolute; display: initial; width: 40px; text-align: right; cursor: text;}
.alertPlugin-onTextLine {visibility: hidden;}
.alertPlugin-hasTooltip .alertPlugin-warningImg,.alertPlugin-hasTooltip .alertPlugin-errorImg {cursor: pointer;}
.alertPlugin-alertLine .alertPlugin-warningElement,.alertPlugin-alertLine .alertPlugin-errorElement {display: inline-block; margin-right: 4px;}
.alertPlugin-isStale {-webkit-filter: opacity(0.4) grayscale(80%); filter: opacity(0.4) grayscale(80%);}
.diagnosticMessage-wrapper {font-family: Consolas, Inconsolata, Menlo, monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.variableNameElement .headerElement {color: rgb(179, 179, 179); font-style: italic;}
.variableNameElement .headerElement .headerDataType {color: rgb(147, 176, 230);}
</style></head><body><div class = "content"><div class = 'SectionBlock containment'><h2 class = "S1"><span class = "S2">境界位置が7.9 mmにあるという情報を事前に与えた場合．</span></h2><div class = "S3"><span class = "S2">"H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_focaldepth00079m_2layers.m"</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% ch 50直下のピクセルにフォーカスをかける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% F値を固定する．最近接距離をいくつに設定する？</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% x-axis: 20 mmのときに全素子を使うという前提を設ける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 対象にする媒質データ：case26を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% IMCL割合を0 %に固定する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% kgrid.x_vec が0となるのは251番目の要素．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% グリッド幅が0.1 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 素子間ピッチが0.4 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% よって，最近接深度(最近接距離は0.4 mm)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 深度ごとの細かい素子割当は，floor()を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の際に参照する音速を1580 m/sとする．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 合計を評価関数として媒質の均質性を評価することも同時に行う．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">clear;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/config/t_pos_2board.mat"</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 初期設定</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_fat = 1450;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_muscle = 1580;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">rate_IMCL = linspace(1,20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">v_reference = zeros(1,length(rate_IMCL));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">t_facing_distance</span><span class = "S8"> = 0.04;</span><span class = "S6">%[m]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">[~,</span><span class = "S8">num_receiver</span><span class = "S7">,num_transmitter] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_echo_receiver = num_transmitter;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_rate_IMCL = length(rate_IMCL);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_medium  = num_rate_IMCL;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">reference_point = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_lowerlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_upperlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">point_maxAmp_in_mask</span><span class = "S8"> = zeros(1,num_echo_receiver);</span><span class = "S6">%マスク処理後のRFデータで振幅最大のサンプル点情報</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">distance_from_focal_point_all = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_signal_total = zeros(length(rate_IMCL),num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_signal_total2 = zeros(length(rate_IMCL),num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">focal_amp</span><span class = "S7"> = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_phase = zeros(length(rate_IMCL),num_depth,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_total = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;</span><span class = "S6">%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_depth = zeros(1,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_point = zeros(2,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_depth(1,ii) = (ii+3)*kgrid.dx;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(1,ii) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ll = 1:20</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,ll);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    [num_sample,~,~] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_amp = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_amp_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S10">for </span><span class = "S7">kk = 1:num_rate_IMCL</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">ii = k</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+24);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%25はfocal_amplitudeを最大にするオフセット．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                reference_point_lowerlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+24-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                reference_point_upperlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+24);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            hilb_rfdata = hilbert(focused_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_amp = abs(hilb_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%         focused_rfdata_phase(:,:,ii) = atan(imag(hilb_rfdata)./real(hilb_rfdata));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_amp_masked = focused_rfdata_amp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked = focused_rfdata;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%RFデータマスキング（均質性評価のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            [~,point_maxAmp_in_mask] = max(focused_rfdata_amp_masked,[],1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%受信ビームフォーミング（整相加算のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_signal_total2(kk,ii) = focal_signal_total2(kk,ii)+ ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_amp(kk,ii,target_element(jj)) = ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%均質性評価指標</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S1"><span class = "S2">参照インデックスを， </span></h2><h2 class = "S13"><span class = "S2">1. rfデータそのものの整相加算に用いて反射強度を計算，境界位置を推定． </span></h2><h2 class = "S13"><span class = "S2">2. rfデータに包絡線処理をしてその最大値と参照インデックスとの距離を測っている．</span></h2><h2 class = "S13"><span class = "S2"> 2.が特に致命的なミス．包絡線処理をすることで，データのピークの位置が変わってしまう．この ミスは，どちらもrfデータorその絶対値を用いて議論することで対策できる．</span></h2><div class = "S3"><span class = "S2">"H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_MT_ecxclude_envelopingProcess_2layers.m"</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% ch 50直下のピクセルにフォーカスをかける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% F値を固定する．最近接距離をいくつに設定する？</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% x-axis: 20 mmのときに全素子を使うという前提を設ける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 対象にする媒質データ：case26を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% IMCL割合を0 %に固定する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% kgrid.x_vec が0となるのは251番目の要素．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% グリッド幅が0.1 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 素子間ピッチが0.4 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% よって，最近接深度(最近接距離は0.4 mm)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 深度ごとの細かい素子割当は，floor()を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の際に参照する音速を1580 m/sとする．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 合計を評価関数として媒質の均質性を評価することも同時に行う．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">clear;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/config/t_pos_2board.mat"</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 初期設定</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_fat = 1450;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_muscle = 1580;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">rate_IMCL = linspace(1,20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">v_reference = zeros(1,length(rate_IMCL));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">t_facing_distance</span><span class = "S8"> = 0.04;</span><span class = "S6">%[m]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">[~,</span><span class = "S8">num_receiver</span><span class = "S7">,num_transmitter] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_echo_receiver = num_transmitter;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_rate_IMCL = length(rate_IMCL);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_medium  = num_rate_IMCL;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">reference_point = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_lowerlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_upperlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">point_maxAmp_in_mask</span><span class = "S8"> = zeros(1,num_echo_receiver);</span><span class = "S6">%マスク処理後のRFデータで振幅最大のサンプル点情報</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">distance_from_focal_point_all = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_signal_total = zeros(length(rate_IMCL),num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_signal_total2 = zeros(length(rate_IMCL),num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_amp = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% focal_phase = zeros(length(rate_IMCL),num_depth,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_total = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;</span><span class = "S6">%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_depth = zeros(1,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_point = zeros(2,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_depth(1,ii) = (ii+3)*kgrid.dx;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(1,ii) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ll = 1:20</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,ll);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    [num_sample,~,~] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_amp = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focused_rfdata_amp_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S10">for </span><span class = "S7">kk = 1:num_rate_IMCL</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">ii = k</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%25はfocal_amplitudeを最大にするオフセット．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                reference_point_lowerlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+1+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                reference_point_upperlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            hilb_rfdata = hilbert(focused_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_amp = abs(hilb_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%         focused_rfdata_phase(:,:,ii) = atan(imag(hilb_rfdata)./real(hilb_rfdata));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_amp_masked = focused_rfdata_amp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked = focused_rfdata;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%RFデータマスキング（均質性評価のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            [~,point_maxAmp_in_mask] = max(focused_rfdata_masked,[],1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%受信ビームフォーミング（整相加算のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_signal_total2(kk,ii) = focal_signal_total2(kk,ii)+ ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                 focal_amp(kk,ii,target_element(jj)) = ...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%均質性評価指標</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity = 1./homogeneity_total;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(homogeneity);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'homogeneity'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'correct IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'predicted IMCL percentage [%]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(homogeneity);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'均質度評価指標'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'正解IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'予測IMCL占有率[%]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/with_rf_signal_predeiction_vs_correct_IMCL_percentage_pcolor'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = "S3"><span class = "S2">2018/11/09</span></div><div class = "S3"><span class = "S2">境界位置を反射強度から推定→波形形状評価</span></div><div class = "S3"><span class = "S2">"H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_2layers_stroke.m"</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 境界面を検出→参照点の妥当性評価</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% ch 50直下のピクセルにフォーカスをかける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% F値を固定する．最近接距離をいくつに設定する？</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% x-axis: 20 mmのときに全素子を使うという前提を設ける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 対象にする媒質データ：case26を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% IMCL割合を0 %に固定する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% kgrid.x_vec が0となるのは251番目の要素．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% グリッド幅が0.1 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 素子間ピッチが0.4 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% よって，最近接深度(最近接距離は0.4 mm)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 深度ごとの細かい素子割当は，floor()を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の際に参照する音速を1580 m/sとする．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 合計を評価関数として媒質の均質性を評価することも同時に行う．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">clear;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/config/t_pos_2board.mat"</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 初期設定</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_fat = 1450;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_muscle = 1580;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">rate_IMCL = linspace(1,20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">v_reference = zeros(1,length(rate_IMCL));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">t_facing_distance</span><span class = "S8"> = 0.04;</span><span class = "S6">%[m]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">[~,</span><span class = "S8">num_receiver</span><span class = "S7">,num_transmitter] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_echo_receiver = num_transmitter;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_rate_IMCL = length(rate_IMCL);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_medium  = num_rate_IMCL;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">reference_point = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_lowerlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_upperlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">point_maxAmp_in_mask = zeros(1,num_echo_receiver);</span><span class = "S6">%マスク処理後のRFデータで振幅最大のサンプル点情報</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">distance_from_focal_point_all = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;</span><span class = "S6">%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_depth = zeros(1,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_point = zeros(2,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_depth(1,ii) = (ii+3)*kgrid.dx;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(1,ii) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">ind_max_signal = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">max_signal = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_total = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ll = 1:num_medium</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,ll);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    [num_sample,~,~] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_signal_total = zeros(num_rate_IMCL,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    </span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S10">for </span><span class = "S7">kk = 1:num_rate_IMCL</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 反射強度プロファイルを求める．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        </span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                </span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%受信ビームフォーミング（整相加算のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    focused_rfdata(reference_point(1,target_element(1,jj)),target_element(1,jj))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 反射強度が最大の焦点位置を探索．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        [max_tmp,ind_tmp] = findpeaks(abs(focal_signal_total(kk,:)),</span><span class = "S9">'Npeaks'</span><span class = "S8">,1,</span><span class = "S9">'SortStr'</span><span class = "S8">,</span><span class = "S9">'descend'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        ind_max_signal(kk,ll) = ind_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        max_signal(kk,ll) = max_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        ii = ind_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 参照点と波面との誤差を評価．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%         focused_rfdata_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%25はfocal_amplitudeを最大にするオフセット．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            reference_point_lowerlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            reference_point_upperlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%         hilb_rfdata = hilbert(focused_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%         focused_rfdata_amp = abs(hilb_rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%         focused_rfdata_amp_masked = focused_rfdata_amp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        focused_rfdata_masked = focused_rfdata;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%RFデータマスキング（均質性評価のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%             focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%             focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        [~,point_maxAmp_in_mask] = max(focused_rfdata_masked,[],1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%均質性評価指標</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_20x20.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity = 1./homogeneity_total;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(homogeneity);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'homogeneity'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'correct IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'predicted IMCL percentage [%]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity = 1./homogeneity_total;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(homogeneity);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'均質度評価指標'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'正解IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'予測IMCL占有率 [%]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">tmp = zeros(20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:20</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    tmp(ii,:) = focal_depth(1,ind_max_signal(ii,:))*1e3;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(tmp);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'媒質境界深度[mm]'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'正解IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'予測IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_detection_depth_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">tmp = zeros(20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:20</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    tmp(ii,:) = focal_depth(1,ind_max_signal(ii,:))*1e3;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(tmp);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'boundary depth[mm]'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'correct IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'predicted IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_detection_depth_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(max_signal);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'信号強度[au]'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'正解IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'予測IMCL占有率 [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_max_intensity_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">pcolor(max_signal);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">c = colorbar;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">c.Label.String = </span><span class = "S9">'Intensity[au]'</span><span class = "S7">;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'correct IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'predicted IMCL percentage [%]'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">equal</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">axis </span><span class = "S14">tight</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">'H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_max_intensity_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng'</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,350]);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S1"><span class = "S2">反射強度による境界位置検出におけるエラーの調査</span></h2><div class = "S3"><span class = "S15">正解IMCL占有率: 10 %, 予測IMCL占有率: 16 %において誤検出が見られた．このときと，検出が正しく機能した，正解IMCL占有率： 10 %, 予測IMCL占有率: 10 %での結果(focal_signal_total</span><span class = "S15">[</span><span class = "S15">dim={20,20}</span><span class = "S15">]</span><span class = "S15">)を比較して，上述したピーク関数を用いる推定方法の問題点を明らかにする．</span></div><div class = "S3"><span class = "S15">"H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_2layers_stroke2.m"</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 境界面を検出→参照点の妥当性評価</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% ch 50直下のピクセルにフォーカスをかける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% F値を固定する．最近接距離をいくつに設定する？</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% x-axis: 20 mmのときに全素子を使うという前提を設ける．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 対象にする媒質データ：case26を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% IMCL割合を0 %に固定する．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% kgrid.x_vec が0となるのは251番目の要素．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% グリッド幅が0.1 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 素子間ピッチが0.4 mm</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% よって，最近接深度(最近接距離は0.4 mm)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 深度ごとの細かい素子割当は，floor()を用いる．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の際に参照する音速を1580 m/sとする．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 合計を評価関数として媒質の均質性を評価することも同時に行う．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">clear;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/config/t_pos_2board.mat"</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">% 初期設定</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_fat = 1450;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">v_muscle = 1580;</span><span class = "S6">%[m/s]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">rate_IMCL = linspace(1,20,20);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">v_reference = zeros(1,length(rate_IMCL));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">t_facing_distance = 0.04;</span><span class = "S6">%[m]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">[~,num_receiver,num_transmitter] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_echo_receiver = num_transmitter;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_rate_IMCL = length(rate_IMCL);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">num_medium  = num_rate_IMCL;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">reference_point = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_lowerlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">reference_point_upperlimit = zeros(1,num_echo_receiver);</span><span class = "S6">%均質性評価のためのRFデータマスキングに使う</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">point_max_in_mask = zeros(1,num_echo_receiver);</span><span class = "S6">%マスク処理後のRFデータで振幅最大のサンプル点情報</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">distance_from_focal_point_all = zeros(1,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;</span><span class = "S6">%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_depth = zeros(1,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_point = zeros(2,num_depth);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_depth(1,ii) = (ii+3)*kgrid.dx;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    focal_point(1,ii) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">ind_max_signal = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">max_signal = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">homogeneity_total = zeros(num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">focal_signal_total = zeros(num_depth,num_rate_IMCL,num_medium);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S10">for </span><span class = "S7">ll = 10</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    pathname = sprintf(</span><span class = "S9">'H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%'</span><span class = "S7">,ll);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    cd(pathname);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'rfdata.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    load(</span><span class = "S9">'kgrid.mat'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    [num_sample,~,~] = size(rfdata);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">    </span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S10">for </span><span class = "S7">kk = 10:6:16</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 反射強度プロファイルを求める．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">ii = 1:num_depth</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                </span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                </span><span class = "S6">%受信ビームフォーミング（整相加算のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                focal_signal_total(ii,kk,ll) = focal_signal_total(ii,kk,ll)+ </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                    focused_rfdata(reference_point(1,target_element(1,jj)),target_element(1,jj))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 反射強度が最大の焦点位置を探索．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        [max_tmp,ind_tmp] = findpeaks(abs(focal_signal_total(:,kk,ll)),</span><span class = "S9">'Npeaks'</span><span class = "S8">,1,</span><span class = "S9">'SortStr'</span><span class = "S8">,</span><span class = "S9">'descend'</span><span class = "S7">);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        ind_max_signal(kk,ll) = ind_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        max_signal(kk,ll) = max_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        ii = ind_tmp;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">        %% 参照点と波面との誤差を評価．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        focused_rfdata = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%         focused_rfdata_masked = zeros(num_sample,num_echo_receiver);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        target_element = find((-focal_depth(1,ii)/2&lt;=t_pos(1,1:100)&amp;(t_pos(1,1:100)&lt;=focal_depth(1,ii)/2)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        distance_from_focal_point = zeros(1,length(target_element));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%受信用の参照点算出</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%25はfocal_amplitudeを最大にするオフセット．</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            reference_point_lowerlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            reference_point_upperlimit(1,jj) </span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%送信ビームフォーミング（共通）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">% 遅延処理</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            delay_time = delay_time_all(1,target_element(jj));</span><span class = "S6">%[sample]</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            read_range_rfdata = length(delay_time+1:num_sample);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)</span><span class = "S11">...</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">                +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));</span><span class = "S6">%整相加算</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        focused_rfdata_masked = focused_rfdata;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S6">%RFデータマスキング（均質性評価のため）</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:num_echo_receiver</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%             focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S6">%             focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        [~,point_max_in_mask] = max(focused_rfdata_masked,[],1);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S10">for </span><span class = "S7">jj = 1:length(target_element)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">            </span><span class = "S6">%均質性評価指標</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">            homogeneity_percel(kk,jj) = abs(point_max_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">        </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">        homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">    </span><span class = "S11">end</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S11">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,16,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">hold </span><span class = "S14">on</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,10,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">title(</span><span class = "S9">'正解IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'焦点深さ[mm]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'信号強度[au]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">legend(</span><span class = "S9">'予測IMCL占有率 = 16 %'</span><span class = "S8">,</span><span class = "S9">'予測IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper outputs'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF"</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,300]);</span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement embeddedOutputsFigure" uid="B79F87A9" data-testid="output_0" style="width: 1820px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="figureElement" style="cursor: default; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><img class="figureImage" src="data:image/png;base64,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o4NdoyfzZAkEHWn0p6qR0hNVivQGq3UNSkc0oANM8kbngnrAqhWPtsfjOwSQLocig25eAxy2dQs1p49jxlnaOnOqaUxfgMFbcrhOicPWcdy2zDztOxB746UhfdmSZf54qsGS34Hg5OgyTCM7b9lhfT2lIHoThSF8EycdVM+E+bBl8hdWYYXpJW2UosJtLJPvZBVW8hjWAUja9t7aRvVW0ulT5Uf1G5p0196CpqSFEhHaJjXvrXQqnuafx7w0K5XzpLfOxrUbM33I8roRZbuuVTV1N7cGcbqt4nytzpz6dxx1+HadBEhempAOSkZpeaNNApikpS0NINYzi1JQ2jnhtqwBEl5Ly+Vx0kW+V6UByNw5c92pI091Z4w6w02aMKnbh7HIoittrs8La184ZLwoqljKrk0MeSj7PVD62wfHUgDkzZfedH379vV137zB9uvXz214ckPpnY0MvX2GLq2ltWyg922gFADZvmG7u+Had7ozHtx30B199NEah6erLloPhDSQDcgG8rSB0jmhOd+Z48ad+4+G2aR4Y8eOdZ/85CcVpIFsQDYQhQ3g05J+rijrpQLI4oWL3QnHn+D2bd9XU1DgUcSpqOlCK6WtNYspqm5FTZdsrQd2VtAah9IAZPkDy91xg47z/dDr0beoD09R06WHurWHusi6ydZau6dF1c2nSwBpva6SNhAaztevWV+z5GFQKaoRzJs3rzWrbsNZSltrIhdVt6KmC5WVtuZtTQDpIT1XLV3lBg0cVBXYZtAI50UFSPNmozOkgBSQAu9WMffQh4Y+sjeXS1OF1WimBRA9clJACsSkgEogbaSnABLTo6O8SAEpIIAIIHoKpIAUkAItKSCACCAtGY5OkgJSQAoIIAKIngIpIAWkQEsKCCACSEuGo5OkgBSQAgKIAKKnQApIASnQkgICiADSkuHoJCkgBaSAACKA6CnIWQENsqkBRnHEeQc/MGKTz4IAIoA0aTI6vLcV8A9hb0eq+KRAkwq0YocCiADSpJnp8N5WoJUHt7fToPikQCt2KIAIIHpyclaglQc35yRXXf7ll192y5cvTw3sC6edO3e6v/3tb27btm1uyZIlPvz617+uHHLllVdWltu58NRTT7nLL7+8oUued9557umnn27oWA468sgj3dtvv93w8Xkd2IodCiACSF72quu+q0ArD26RxHv++efdlClT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" style="width: 400px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"></div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,16,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">hold </span><span class = "S14">on</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,10,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">title(</span><span class = "S9">'正解IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'焦点深さ[mm]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'信号強度[au]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">legend(</span><span class = "S9">'予測IMCL占有率 = 16 %'</span><span class = "S8">,</span><span class = "S9">'予測IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">xlim([6.4 12.3])</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">ylim([-0.82 1.68])</span></div></div><div class = 'inlineWrapper outputs'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF_detail"</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,300]);</span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement embeddedOutputsFigure" uid="57835899" data-testid="output_1" style="width: 1820px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="figureElement" style="cursor: default; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><img class="figureImage" src="data:image/png;base64,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" style="width: 400px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"></div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">load(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat"</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">figure;</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,16,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">hold </span><span class = "S14">on</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">plot(focal_depth*1e3,focal_signal_total(:,10,10));</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">title(</span><span class = "S9">'正解IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">xlabel(</span><span class = "S9">'焦点深さ[mm]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">ylabel(</span><span class = "S9">'信号強度[au]'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S8">legend(</span><span class = "S9">'予測IMCL占有率 = 16 %'</span><span class = "S8">,</span><span class = "S9">'予測IMCL占有率 = 10 %'</span><span class = "S7">)</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">xlim([0.0 21.3])</span></div></div><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7">ylim([-0.95 2.00])</span></div></div><div class = 'inlineWrapper outputs'><div class = "S5 lineNode"><span class = "S8">exportfig(</span><span class = "S9">"H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF_detail2"</span><span class = "S8">,</span><span class = "S9">'png'</span><span class = "S7">,[400,300]);</span></div><div class="outputParagraph" style="white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="inlineElement embeddedOutputsFigure" uid="05DA48B6" data-testid="output_2" style="width: 1820px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><div class="figureElement" style="cursor: default; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"><img class="figureImage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAEsCAYAAADtt+XCAAA/k0lEQVR4Ae2dC/BWVd3vmXHe6XTe08xpTqdTncZxOqMlaUR0II0hL5ERaZImKgyRh3ghvBFeD951zDBNMJJ8OcZrYZiZEcNLxJFX8fKaCREqcQkhCrwgehiHNNNZh8/S38N6Nns/l/08z7493z2z//vyrL32Wt/1W7/PXmvtvf4D3P9zA7RKA9mAbEA2IBto1wYEDwFUNiAbkA3IBlLZQKqL2qWUwuvJRjYgG5ANVM8GBBA9ecgGZAOyAdlAKhtIdZGeJKr3JKEyVZnKBmQD7dqAAKInD9mAbEA2IBtIZQOpLmqXUgqvJxvZgGxANlA9GxBA9OSRqQ3s3LDTLf3pUlcWZ7Jl7Rb30wU/bSu93/3Wdx3XtZvHaV+f5vY+u7ft69q9j8JXz5HnVaaZOo+8Mqn7dr/CPPrrR92iOxY1XZ944Ik6h3jjtTe6gz94sDvh+BMcDnPlkpXuA+/7gHv3f363e+9/fa9fv3LyV+quybP87px3pxt9wuiW0/PmS2+6AQMGuG1Pbmt4Dbrct/C+upXrouceX/l4w3jy1Eb37n69KpumAohaIKls4Ae3/MBNmjCpbn3HO97hPnvMZ+vO3TX/rpoDxLl+6JAPuc1rNrvp35juwt9GjRzlcKrLf77cnfmVM/01l114mYfL+LHj3d9e+Jvfv/DcC2vxUdkszrPGn1V3HrgN+fgQ967/9C6/DVsRhxx8iGvVMQOQQUcMcmzDdfvT22v3u+qSq9yYL47xK/kABHYc3f79xb/769BvwukT6lbCRs/N/c7c2n264Vy+9IUveS0tLvSmTN75H97p7/3qc6/G3o9wRw480l3zv6/xv1NWlKPFo21/wiSV85Cx9KexNCv39/yX9/gn6KRwN1x1gxv8scFu/q3z3fv+2/v89i9/+IuHBs4J5wpUABNxPP3Y0+4f/uEf3B1z7/BOD8dMKwVo2D3oDjOHbedw9IRb8YsVPs57f3Svd5AcEwbQrVq2qhaHXRe3JS5aSKefcnrdGgIIZ0rcrEDguBHH1Y7tvG0t7S/88QUP0Ze2veRw2kDousuuc79/5Pc+Xb976Hc+LgNOXNraOYeGtKTQChhzLWn4x//4j15/zgH/KKDtHoDtgaUP+NYj5wCg/aZt//oDAWRfZVAFSKcBTgcHa06uEUBwiMAAJzXj7Bnu4vMvdsM/NdzRyvjwoR/2XT60NGgxhK0Fc/bcC+f30Y981Ds8KzMcGy0EHDfncNDAI4yD87R4TjnpFB/G4rQ4Gm3JX6tdWMCArrijhx19QEvisf/7WJ3DZaxj4pkT3dT/NdVrAFAJA0gBJ3mgFZWUtrgWDFoktSCI55Udr9QB5Me3/9in1e6x+CeLPdjtONwSN9AFprS+6HoMf9d+ujpUdt3kPAWQ1Dbw4jMveodklQCAAARaBaz2NM3vtDSuuPiKAwBC1wgDzoypMCYSdYDm7A0gtGJwvMQJuHiCZlzFAEJr4KCDDqprpdj9zYlbnJbuRtt2AHLi50/0LZ3o2BBASYKBtWTIO2NDtMBMu1C/aBqBjLVqwq3BPBqe4yhAgCotKwtLCwNI23G4Jez1V1zvuwNpQYa/ab8/4UG5p3YeMpr+NRor+ziA0Kqw7p5o/z2OccTRI9zkiZM9LIYOGeqdINDhSZzWB4427F4yZ28AYXCacLQ0GHCmuwgnbwDhHvxuaYzbWpxxv3EOEDImQDzRlfO0osJrcczAg5YUrSye1sOVMZcoQPb8eY9jPIIXBviNFgeAJR7uT5cT907qUgrv3+p+FCBAKwQIuicBhO6u86ac58vmtptv8+UnkMgHCCD7HEarFVDh6rWKAwhOPUknnDuD3XSd0MWE82TLkzfjHjh2trNvmF2Lw5y9AYQt0KC7BeeHow0BQisjrgXC07yNrVicSenEgZPWuN/JXwiQ5zY95wDEMcOPcewDmOibVEA1ChC68IAMLQYGpnHKOO9lP1vm6J6ixcYgNU/9cekgzwAgukZbcOG1UYDQlRi+8daoBWLxcF9WXlWmZWVjOva7tvV1pOp6yHkKIKltIA1AcLa0Flg/+IEPepjgQOmG4YnbumMYT6DymbMPAcKTL0/vOGucYggQGwOJAgCnzFtZYZxJlbsdgBAHQOS+pJEWSNSpH/o/Dq0DCN/CLLhtgU+3OWS2ACQ8tn1gEk0rXXVRUHHcThcW3WWMuVjcvGwAzO04bmvABoiUIXmOC6dz/QGS1M5DBtIfBtKonNsFCA6LbhCLkxYEbx4ZUICF7dNiiHsLC4dF9w+OGogQF46W6yxenBxwsvEFxlcYpMZpE4b7MPYCfMLVrm8XIHYdaQNq5vht+6n/+ak6gGx8YuMBkAE6ACQKH47Rwe7RyTbaAkFHBv3paqT1RJcib4Ml3YPWEQPoAJO88XJBI2AlxaPz1fEdAsg+hyKDbl8DHLa9FmpOH8eMs7RjtnTTmL4Ag6fk8JgWhx3juG2fbdx3IPbEy0D6kkVLfHi6waLfgeDkeGWYQXaessP+elpBvE0UruGTOOmgeybMh+2Tv7ALK0wvaaMVFZ5jn3xHu7CiYTgGIHHnu3WO7q2o06fLj+43NGk23oKmpIUWEdpGNe9WOhVP+/UxL81K5Tx5W2f94+t7WsnyKoiy3de6mpptbUCc11ZxvtZnTv87jjp8uo4CJC9NSActo7i8MSYBTOLSFgcQezOLVlDcNeG5XgMkvJf2y+Oki1xWpQHI7Fmz3UmjT3KnjjnVTZk0pWllLLLoSpsb8IfH/3DAfFF0sZRdmyrkoexloPRnB8dSAOS1519zAwcO9H3fPMEOGjTIrXt0XemdjQw9O0OX1tJaNtB9GygFQLau2+quv+qt1xnf2P2GO+KIIzQPz76+aFUIaSAbkA3kaQOlc0Kzrp3lJpy5f2A2Kt748ePdYYcdplUayAZkA5WwAXxa1M8V5bhUAFk4f6E79jPHut1bdycKCjy0JCsgfZK1sV+kkSmRvJVGydrYL93SyMdT0B6H0gBk6T1L3VHDjvLvoTeib7cKzYygalvp07xEpZE0aq5A8xDdsiMfjwCSvq+SMRAGztesWpPY8jCodKvQmptHOUPMmTOnnAnPMNXSqLnY0ig7jQSQDum5YvEKN2zosLqVcwaNcCuANDdshZACUqA8CgggHQIkBESzfQGkPBVDKZUCUqC5AgKIANLcShRCCkgBKRCjgAAigMSYhU5JASkgBZorIIAIIM2tRCGkgBSQAjEKCCACSIxZ6JQUkAJSoLkCAogA0txKFEIKSAEpEKOAACKAxJiFTkkBKSAFmisggAggza1EIaSAFJACMQoIIAJIjFnoVJYKaJJNTTCKI8579RMjtmn4AogA0qbJKHi3FfCVsNuRKj4p0KYCaexQABFA2jQzBe+2AmkqbrfToPikQBo7FEAEENWcnBVIU3FzTnLd7V944QW3dOnS2JXfwmX79u3ub3/7m9uyZYtbtGiRXx9++OFakIsvvri2n+XOY4895i688MKWbnnWWWe5J554oqWwBDr00EPdm2++2XL4vAKmsUMBRADJy15137cVSFNxiyTe008/7aZNm1a3jho1yh100EFu7ty5dUm96aab3Ic//GE3f/58N2PGDHfnnXe6MWPGuJ/+9Kfud7/7nXvPe97jwz/wwAM+zLZt29xf/vIXvx+FEXEAIlu45pxzznE33HCDv4bzf//7392Pf/xjC5K4BYAnnniie+WVV2rrq6++WgtvsGP7vve9z6cnPMf+c88958MPGTLEfeADH6it73rXu2r7nD/yyCNr8abZ4T4hdInjpZdectddd5377ne/6wEdjZcyQhvCsTz55JPRIH4M5oCTTU4IIAJIExPRz71WoOwAMX1wYMccc4y7/vrr3YgRIxxOK27ZuHHjAQABQPfdd18NIMuWLXPvfve7HQBZsWKFGzBggLv11ltr0a1cudKfw3GzXHPNNf7eixcv9tA6+OCDPUQAAk672QJA3vve97rPfvaztRXY2QLoWK+44gp3yCGH+H07Z9udO3f64LROgCELUANoBr/bbrvN0QpLuwBatOWe4XLcccf5fJ933nmONbqceeaZvrXHdcDHYBeGS2OHAogAEtqQ9nNQIE3FzSGZLd0SB46Dvffee2vh6bJioTUwadIk1wpAQscPQA4//HB39NFH1+IkHloCAATHTcuFa2yhK+yyyy7z51oFCC2hZgv3pUuKra2zZ8+uu4yn+8GDB3t40PpAC1o3AJKWGTpEF1pqFp9t//CHP0SD+fxMnjy5DiCEA9wsgGrVqlUHXHf66ad7ENNqM+hGA6WxQwFEAInakY4zViBNxc04iYm3wxmOHj26bn3nO99ZO+afrQ0dOrR2Pc6UsQYcGU/KbHHc0RZIFCDcA4DQImE8AUgxFoEzxDF/5Stfqd2DHdJFF1QYT12AfQd059jYzVVXXeXjt2O2Bj67jnvREqJlAtRYaSmRtuiyfPlyHz9wOeGEE9yNN97ou4249sUXX4wG9+nlfuGaNG6CVmELBE2HDx/uaIUAWlo90WX69Olu6tSpvosrrvuK8GnsUAARQKK2puOMFYhW3Ct/9Ywb8M37C7uSvkaLPfEzPsF4BwPU4YJjBBy0EHD+rQIEZ4wjXrJkiXeGPKnj1FmTvmFoBBCe1Onqsif+cPvBD36wztHTRUZYIEbXGnm0NQoQurkI94Mf/MCHpVvsS1/6kgcJ+SbusLUUatPKfhQg5P+jH/2ovxSg0cUVXQAT+b3rrrt8fklPFFBRO4zGEXcsgAggcXahcxkqkKbiZpi8tm+FY2X8g6fhRx99tO56ulhOOeWUpmMgoePnSR8nzbV0DdGfjzM0gACosJXDDXkqp9smjKcuIfsOiCPq/C0MTt9aCnS50fXE/YmT1gm/sdJ9FsaBU6Ybb8+ePX6lFUT3Gg587969fss1UedNy4S4wzWppRAFSNgC474ALm7hNwDDPYjDBtQtbBo7FEAEELMfbXNSIE3FzSmpLd3WWiBRB8XFPJ3jLDdv3uy7sOg64qkYJ42DtrewuJZ4cLQGEK6nm+ZDH/oQuzWAsM+bT/a2FU6bMYEFCxZ0BSDEbwvOlzSYo6frLASIQYlztr7jHe+o7ds5XgJIu0QBwoA4rSNgSeuMLrO4hZYKC2mnOytaPmnsUAARQOJsTecyVCBNxc0weW3fygASvZAnb7pveBLmldIJEyb47i1eawUeLAYQnCT7PO3jlHF6LPT9AyEW+vV5+mbBiRKGgXUAw5tgLDhV4iFNtlp3F/GSHtIRXQlrLRAf0dt/uAfX2ULLIgSInQ+3lqfwXCf7dOUB1XABnrTOaIklvf1Gq4wFbU3PMI40diiACCChDWk/BwXSVNwcktnSLRnzmDhxYmxYnnhxdIyNGAQIyKAvjv6OO+5IHMuIjbDDk3R90VWFM46uDPCTpugCfOwbDFpHvF1lsIqGtWM0KcOSxg4FEAGkDLZd6TSmqbiVFkSZy0WBNHYogAgguRirbrpfgTQVd//V2pMC3VEgjR0KIAJId6xPsaRWIE3FTX0zXSgFEhRIY4cCiACSYE46nZUCaSpuVmlr5T4MgIcf4IX7Njhu8WgyRVOieNs0diiACCDFs+Q+S1GailskiXjrhzd7wlWTKe5/6yuLyRSZe4tXc3lFOm6qFMpIkylm6OxdD+5VdkdRJKdVpbRUxS40mWI+kykyvQtTu/ANCBAHFNFFkyn2wKH3AhKN4qyKo4gap447U6BKdqHJFN+aKj3LyRR5jdj+jwqtD+Yiiy5898GrykylYh8URsOksUN/TUF984BGzriMv6UpoGgh67h6CkTt4sW7v+M2nvL+wq6kzxZNppj/ZIp8dxNOrkiXWfi/TCgrTaZYUMq1A7Koo7BKqG1/K1A1u7Av0TWZYjaTKfIVfRQgzLsVLppMUQAJ7UH7FVKgigDRZIrZTaZI64JZim2hCys6WSO/aTLFkkOkao7CDLbftq8/v93tfeqRrmW7anZhLZDoZH0IpskU35pksZuTKTI3F/93hW4rBtL53yBxi419MB6iyRRLCJOqOYo4I+2Hc4wBhOMAnea5anZhAInqoskUo4qkO46bTJEWCJNIMlNw0r/M1WSKOUJjy9otLm68Y++ze93Lf3q5tr6+6/XYcFxbNUeRzvzLf5UAklyGmkzxQG00maLL5YWoXG4aB4m1D691UyZNiQXDiOEj3NSvT3XTJu/7kGrfuuGJDbHhBJADK1ZZzwggZS05pbuRAmkecP01OT7Yx/lrO1cIgCycv9BNHD/RTf7a5FgwDP744Njzlolwm6aAGhW4fstHgWdvPU9dWPlIr7v2UIE0/kkAaYGeKxavaAiQuTfNdRedf5Fbs2pNQ5ggtq1z5szpoSko6l4q0G2A8D8mzC603V9HpEW2Wtg/2mpWd/BdYdmED8lF2i9ECwRBkgDyxu43/NsPS+5e4tY/vt4N+cQQt3PjvukMEqCE6FrKr0C3AVJ+RZSDflXA+7QEf5fkB7M6X3iARIWgm2vZvcsEkIrXJgGk4gWs7LWsgADSAj2TWiA7Nuxwj/x63/cAb8cxaeIkR1g7jm7VAmnZLgsdUAApdPEocRkqIICkAMieP+9xm9Zsctue3OaGDR3mOAYmfMyza8suASRDA87jVgJIHqrrnkVUQABpASCrH1ztbvn2LTUw0OqYfvZ0f7zoh4scr/KOPG6kW7lkZS1MtPXBsVogRawC7acJgLBqkQL9roAA0gJA4mCQ5pwAUo3qJoBUoxyVi84VEEAEkM6tqM9iEED6rMCV3UQFBBABJNE49EO8AgJIvC46238KCCACSP9ZfYc5FkA6FFCXV0YBAUQAqYwxZ5URASQrpXWfoisggAggRbfRwqVPAClckShBOSkggAggOZleeW+7/Yov6zXe8hafUt5FBQQQAaSL5tQfUQkg/VHOymVzBQQQAaS5lShEnQICSJ0cOuhjBQQQAaSPzT9d1gWQdLrpquopIIAIINWz6h7nSADpscCKvjQKCCACSGmMtSgJFUCKUhJKR94KCCACSN42WLr7AxBWLVKg3xUQQASQfq8DbedfAGlbMl1QUQUEEAGkoqbdu2wJIL3TVjGXSwEBRAApl8UWILUCSAEKQUkohAICiABSCEMsUyIEkDKVltLaSwUEEAGkl/ZVybifmTJUg+iVLFllql0FBBABpF2b6fvwAkjfm4AEeFsBAUQAUWVoUwEBpE3BFLyyCgggAkhljbtXGRNAeqWs4i2bAgKIAFI2m809vQJI7kWgBBREAQFEACmIKZYnGQJIecpKKe2tAgKIANJbC6tg7AJIBQtVWUqlgAAigKQynH6+SADp59JX3kMFBBABJLQH7begAABh1SIF+l0BAUQA6fc60Hb+BZC2JdMFFVVAABFAKmravcuWANI7bRVzuRQQQASQcllsAVIrgBSgEJSEQigggAgghTDEMiVi4ynv1xhImQpMae2ZAgKIANIz46pqxAJIVUtW+WpXAQFEAGnXZvo+vADS9yYgAd5WQADpIkC2rN3iXIP4vNgyvdIrIICUvgiVgS4pIIA0cPiNYBD9be3Da92USVMEkC4ZZpGjEUCKXDpKW5YKCCBdAMjC+QvdxPET3eSvTRZAsrTenO4lgOQkvG5bOAUEkC4AhNbIisUrBJDCmXdvEiSA9EZXxVo+BQSQjAGC4Kxz5swpn7UoxV4BAUSG0M8K4LvMjwkgGQOknw2vKnkXQKpSkspHpwoIIAJIpzbUd9cLIH1X5MpwggKVAMi2J7e5Vtfo21PdOtYYSIKFVfA0AGHVIgX6XYHSA2T31t2+P+6M085wzVYyS/huQSOMZ/WDq90t376lYdxe7H63uArkXwCpQCEqC11RoBIAOWn0SQ0dtzl6wvUKIHaPRlsBpCs2m2skrz+/3c+DpRZIrsWgmxdEgUoAZNzYcS0BhHACSEEsr6TJEEBKWnBKdk8UKD1A4p74Tx1zqjv+2OPr1rGnjm0JMnHxdeucWiA9seFMIxVAMpVbNyu4ApUEyI4NO5yt6x5d5z525MfcpjWbBJCCG2MZkieAlKGUlMasFKgkQKIthjdfetONGD5CAMnKqip8HwGkwoWrrLWtQF8ABKAcfdTRAkjb5qELogoIIFFFdNzPClQSILxtRYvD1mFDh7lJEycJIP1s6V3KuwDSJSEVTSUUqCRAdm7c6cL1hT++kDs8aAV5sSthNv2bCQGkf8teOT9QgUoCJDoGUpRjAeRAAyzbGQGkbCWm9PZSgcoChKlN+A+Btv5y0S9zb4UIIL005WziFkCy0Vl3KYcClQTI9LOnu6OGHeWnOBn9+dF+e9aEswSQcthkoVMpgBS6eJS4jBWoJEAGDRrkeHV35HEj/ZfnfAMy6nOjBJCMjauKtzOAPDNlqGNfixToZwUqCZDBHx/sXnv+NTf/e/Pdb1b+xoODjwnzHgtRF1b5q9repx5x26/4sp8PSwApf3kqB50pUEmAzLtlnhv+6eFu15Zdvvvq5BNPLvSHhFt3v+p++PjOzkpSV2eigACSicy6SUkUqARAeGU32rp4+U8v+3MMol9+8eV+Py5c9LpeHie1QP7tjy+5Q657pCQm09/JFED6u/yV+3oFSg8QZtct+3TuAki9URb5SAApcukobVkrIIB06V/attJyadQCGfDN+7Mue90vhQICSArRdEllFagEQA7/yOHuk0M+2XQlXBH/HwjjHwJIOeqYAFKOclIqs1Gg9ABp5cm/KGGSWiAGEAbTtRRbAQGk2OWj1GWrQF8BhG9D8oSJAJKtcffibgJIL1RVnGVVoBIAYbLE0758mocDr+zGQeKvz/3Vv9LLNu73LM41AwiD6VqKrYAAUuzyUeqyVaAyADn2M8d6MPD9h8GAFsfSe5b64+c2P+eGfGJI7TcLk+VWAMnWuHtxNwGkF6oqzrIqUCmArFq2yn9AuP7x9Y51wxMbfKvj/iX3u3vuvMedcdoZhQaIPiYsfjUSQIpfRkphdgpUCiDjxo7zwBhz0hjHfFjMgbVyyUp/jtYHM/Rm2eKI3iupBXLlr57xb2EJINkZfto77Vl5t3v21vM0lUlaAXVdpRQoPUC2rtvq1qxa48IuLMZEgAgA4be5N811RZ4LywDCVkuxFTCAMB8WrREtUqCfFSg9QKZ+faof2wAggIMxkKcee6oGkJkXznT8S9vjjz3eLbt3WaFbIAJI8auiAFL8MlIKs1Og9AChmwhwABBaHWSI/4V+zGeO8S2Q8aeP99BgPIRz0W6lLI+92DFlCziYC2viT9bH/KpTRVJAAClSaSgteStQKYAAg/AtLOvC4jzTu5PZN3a/kRtEGgHkmLmrHauWYisggBS7fJS6bBWoHECSvgMBIgysF3EqE1oerAJItsaf5m5xAGEGAZVdGjV1TdkVqAxAyAhjHeF69FFH+66tsaeOzf0NLACW1AIRQMpTjUKAnHbZfJ9wm4pGH4KWpxyV0u4oUAmA4JxpWURXxka2P73dv4XFfylkbISwea2NAGLjIN0pVsXSKwVCgAz9xvec/TMwJsPUSxC9Ul3xFlWBygCkFSgUdS4sWiACSFGrSH26ogCh1UHZaQyrXicd9YcCfQWQPX/eU9gWiHWD9IfZlTeXcQDRA0B5y1Mp70yBSgHkkm9e4iaOn+gh8dsHfutsfX3X6+6oYUe5RgPsjVowqx9c7T9IjAuz99m9jn+fayv3igvHuUZdWAJIZ4ac1dVRgND6ACCUH69iaxwkq5LQfYqgQGUAMmnipNrX5syDteiHi/x8WIx72D+c2rVlV6JzT3L6k7822fEtCdOkcI9oOOLnY8Zpk6f5le9NomHsOAkgdH+YA9L/BClCtUhOQxxAAIe9iSWAJGunX6qnQGUAMv3s6X6QnBYAAFn36DrvyHHwtBIWzl/oPyw0Z97KlskZw/+3zj7nwmsZnA+PG+03AgiOB5DIARW7koUA4S0syswAQmuEVYsU6BcFSg8Qpmm/eubV3okzXQldVeFKBu349jm3t+zsAcHN37rZMRWKQeHSGZe6WdfOqh1zHoAw19ZF51+U2M1l15MWW+fMmVOzMZzQvy5e6laOPdK9ePd3aue1UzwFKB9W5sIygNi/IxZAildeSlH3FcB3mR9ja/6taNuWX7eli2ngwIF+Tixe2422QMgYky62OwYCPAxOxHHlpVfWAYWv2vk4ccndS/w9mfF358adiYJ6sWPKc9zs5R4ePN0+M2Woe/357TGhdKoICoQAueimH/tZlGmBsFgrsgjpVBqkQBYKVAIgOHfAQWYYgwAgdFnRjWXfftBSsRl7WyUlAAEaFv7yiy+vA4idty3jJY0mbEwCCI6IJ1oWIGL7/oT+FEoBAwhTui/+53keILQgWQSQQhWVEpOBApUBCE6cyRTpTmKfadxt5ZgB9HYnU1wwb4Gbce6MGkAuOO8CxzkDxo4NO9wjv9739LkvflYG2VcsXlE7tvO2TQIIXSEGDaYIf+jsL2RQ9LpFGgVCgPz+3gV1k2AykG6tkTRx6xopUDYFKgGQCWdO8P8Tnf+LzrQlOGycO8fzbpnnp3ffsnaLa/SKrTn5cMs/oGKMY/OazY74mCaFrjC+J2GiRn7nHMf8TndWoze9kgAy/ZIb/D8pwnjovmIsRIPpxaxKUYDQ+uA1XhYBpJhlplT1ToFKAIQZeHHmtDjsrSkcOv/C9oarb/DTvJ8w8oRUs/Euv2+5G/W5UX5lH8DQ6uCtL/Z5XZhuspHHjfT//TAEUHS/HYBYt0jvil4xp1EgBAjdjZQTr2DbYm9k2bG2UqDKClQGIDhr5sICIGwNIKETx9HzW3guy/1WAIKxbTzl/eoKKWitiwIk+t0OQFHrsaCFp2R1XYHKAcRe5eWtLF7fDQHBGEUZAMKbWJ++arEcUdfNvfMIowCJxiiARBXRcZUVqARAkqCQ99xXIbzYT2qBfOeCGXXffzCgzptZ+iiteFXPAPLv1/yTf2MumkKb1iR6XsdSoIoKVAIgUUfNMWMicefzPJcEkLPPmnYAQPiwUOMgxatyzQCijwmLV2ZKUe8UqCRAGEy3/4WeJzCi924VIHxjYK+I9q7oFXMaBQwgPzn/q7EtEAbU7a2sNPHrGilQJgUqARC6sMLVAMKHhD+6/Uf+n0rl/b9AgEkSQG746ml1zsiclE2RUSaDqnparWySAMIAut7EqroVKH+mQOkBAjjIBN9jsOUtrBAgnPvkkE/638JpSaKtgyyOvdimfLCNAwitEA3IBiIVZJdy4fXdJICQTLqxBJGCFJiS0VMFvE/b93Cchf9s9x4tJQqA2HQldFsBjxAgfAvCjfkYMO/MtgoQvkZnIB1H9LPrZ/r9TRs29dQQFHlrCrQCEGIS/FvTU6HKrUDePrURVLoKEEBzxBFH5Dqw3i5AnrjtOg8PYMJ0J1ryV8AAEn3xIZoyvY0VVUTHVVSgbwACqex/hDSiVi9/iwMIH6L9aNxxjlaHLUxnwrcgrJzHaTHdiV7rNYXy27YKEL2NlV8Z6c7ZKdBXAOklHFqJu12A8EU6CwO3PPEKINlVjKQ7CSBJyuh8PypQWYCQMWbntTGQVhx8r8O0ChAMEXjgrFhohdBK0euhXo5c/1AmvGLdrAtLr/PmWky6eUYKVAIgZMImSzx1zKm1QXT+lwe/MQ17r+HQSvxJAGH23eg/kWLcw7q1bIZefViYUa1ocJtWAaL/DdJARP1UGQVKDxAcN1+dh6u9hcVvRfj+w+DSDkCiFkaLRACJqpL9MQDhH0k1a4EIINmXje6YvQKVAIg5aNuGALFzRdjGAQRHE9cCiZqC3sSKKpLPcasA0f8Gyad8dNdsFagkQIBF3m9cxQFLAMnWuHtxt1YBwr01k0AvSkBxFkmBSgGkaLPvRiGSBBB726qRYfAmFrP2aslXAQAye9YtTbuwSKW+Rs+3rHT33itQGYDs3LjT8b9Aok57/ePrXbhGf8/yuBOAMH0GU55oyVeBdgCir9HzLSvdvfcKlB4grz3/mjvmM8c4A8jUr0/1b2GdfOLJ/tyQTwzx82MxR1YRv0RnDKSVFoi9yhv9D3i9NxHdIVSAsajv//DellogAkionParqEAlAAIkDCA2HxatEc7x2xu736i92ptliyN6r7gWCHNc8cV5s0UAaaZQNr+3C5Dw/6Vnk0LdRQpkp4AAsm/APeroe3UcB5Bf75tyvhWA2LcgtFi05KcAAOG/RTZ7jZcUppnOhGv0unZ+5as7t6eAACKAtGcxfR66lwDh4YA3t8KuL3VZ9rnBFTz7AkjOAFm/6n4/424rdsJYiVogrSjVuzAGECa3ZEC90dLudCa8tUX5sgIRpq7hnJ1vdC/9JgXyUKASALHxDrbnTDnHj3cwpYmNgfDPpuwfTu19du8Bb2r1qssqGm9cF1Y7AKGriy4vLfkpAECYWp9XeZsBpJ2PCQGGTZbJdcDD5j4LWyT55Vx3lgIHKlB6gJiTtkF0O7Zt+K9u2bfzeWw7BQjO618XLz2wFHUmMwXaAQiJCkGQlEhaKkAiaUkzlpIUl85LgW4qUHqAAI5jP3OsnzBxx4YdrtmaBzjsngJIN003n7jaBQitiWYtiGZdVO12heWjjO7ajwqUHiA4501rNrnLL77cDf74YD/7LpkCKnFr0bqwmBq8WVeIGSbhmMhPS34KtAsQUsqYBpCIW1qBg42JxF2vc1IgTwUqARB7wmf70K8ecgMHDnSMgYTni7Af1wJpByBMZ8K/ueWrdJvqPU/j6cd7pwEIOtGVZWMcoW7NWh+EjY6lcMyqpVwK8Cq+1WG+/2LhHDbFWsalcgAxUNCVZftF2XYKEMDx79f8k/9u5GfXzyyjvZU+zWkBEteKaKX1YYKFEzMCnSiMcERaiqkA5czYJW9R8v0QPQm8EEN95hxb7Cp8KORcGcq0sgApCjTCdHQKEAwMQ8PoHjr7C8WsLRVJlT0tUtnR2yo823Gzl7f0FlYoRVwropXWh8Vh4yiAg+vCQXdzRKEDIp1h1yj5IVy4lMFBhekt2z5lBfjZ8i8bgIi1HAEJZUSZ8Tv/cZTWCQvnsDk7LnK+BZCcvwPBSFo1FDMsDA+D46k2qWukyEZXhrThfCkXc8r2lIj2n75qsR+LCh10K3nC8ZsDwbHwZNrqAjAoa7suDiChHeGAeNiwc+yzkn6DCWEsD5xj335vNV0Kt18Ba1ECBABBHeVBD91NZwtN+RHexseY3YBwLGwpN8rC7MWuK9pWAMkZIIxpWCVvZhxUcnsy4YkGQ8UpsWrpngIGizBGQGIOOC1AcBoG/XbgQTooa+DB9dHWDM7JHA5hST/nsBdzRuac+A3HhB2xb8ecC+MhPlYDKPFqOVABysLqId8HzfzRg36qG/RFO9M4eiXliD1Ymf7z0t/4ciE8ZWV1HVsr8iKAdAkgqx9c7T9gDLusovtxXVjtAsSeZDDQ8GkUg2x1MSfUaviqhqOS4iSptCw84aMNFdjOWd4Ji5NlTQsQHI2BIM2TpV3DlrK3BZvgZQyeeHFaHFv6Ld0hCAwOdj1hWG1h38IQl8EljMPC9uOWMjTnz8MbrQfqo9kH22ZaUYZca/WWLeVn4LHjod/4nv94GJu0ul8kzQWQLgBk8tcmO2YBHjd2nJs0cVLi4H0cQMLK3o5hYKQ87bDwNIsRJy1mpPxuzqcfWy04RnvCs8qOo2SfGQFwyvzTLipxdOFauyYtQCgH7gGoOl0oPwMK6SJN2IClMQRCp/cy3YjbgMK+gdZ+R9tu3rfTdDe6Hu2oN9Qh4It2QIEuJ8sbYxbAwhYrvzGTr/Th0ILVnD7hyD821e5CeojXwE9aeGWfngbSY3babsu13XS0G14A6RAgq5at8v9vxFob/N8RztlxuO0mQKi89pRjlTqu8O1JySDCMUbI1s7FXZf2nFVMnKQ5uGZxRZ2OVUIqDRXKtuSXCk+rjTzzG/fglUjCcI4t4fgNjezJja1VRH4P70lYHAeOgAprukbTze/EkRYgpNVajdG42z0GdKSbhXRRnsTPPx3juBcLmpk27HN/9GBFe7NDKy8rC9Ji11qa200f17Nis+TVnvz53yzWcsQOLH7CYedM/cOWLiLSw1uMaMQYhbUcLN3oxj5hgQr5wh6Y9wy9cfD2NpXln/ux3+litkE8Vj+Jlwcb8stCemiRkDd+Iz95LwJIhwC5+Vs3u5kX7nul9u14Lp1xqZt17azasZ1n202AYOhWWTB8DD0KBDNEq3R2jNGF+xxjwKyNFn7niYwK+9/PXeTnhKLScp6KinO3ikk4Kjn3YZ8t4UJnj1O3tFtltWPiYf3J+V91vLJMpaeJTzgAQmXmHMdcQwWncrMlHNcShjmr0IlrovqEeQUKpK8RWO1ehOVepL/dpR2wJsWN4zA9sAPya3njDTH2LS/RlqaFS4q70/M4NtLESjrZGrzZcoyO7Nt5ju2cXWv5A+ycw74N8lYOdg2/2YoW7HM9W4ubLemxhwtLhwExLt/kBdshnVzLSjxW7+Ku6eQctod98JBB+bGwpQxZyRvQo55h86SF416XaaM8CSAdAgR4XD3z6howrrz0yjqgRAGC4Kxz5szx5YKRsra7mEFjzFQGDIonJ4wJI2Rhi+PmaQqnFzpHczCEZzUjtSY7v3M95znHtUCDJyCMNnQGZsxW0axyUuGpyDhzjN/C4cxpntvTI/GTBnRga8ehJqSH1Rb2o2klvZyzsAZJyxt5YN/isS3X8RsL13McLoQjXeSPPKBDO5NghnF1Yx99gSP6kR6ObbH0kx/2cUaknQU9wmPOkTfC8Vs3ljA+K0ugZmVjWmNHDDpjl6yEAcrYM9qyxbnbamVl9SWsM7ZPGFaOud7OdyNfFkcj4FiYtFvTzsrL4uGYlTrPwxR1iXTwsMRqtosdkG/KEp1NM+KxcxZnJ1t8l/kxAaQLAAEaBgqmVAlbJHY+qQWStiAxFHPUGBPODcduzpJ42ceJ86TC0xiVlIVrMUaMkjDmVMyAOYeTJD7gQxMeoyUe7sNqFYlKGhqqv8G+P5wnjN2LbV5LWCGpSOTPYELerQKSPvLC72GeCMM5g2DeAKEceArF8dNCs7Ig/eSV9BoQzHHzm+WZ62whXxzzm+lE3rk+PCaMHXOthSF+u4fpxDHxsXIdcYVrGI+lQ9vmClDO1tJCWwBM/aYMqZPYBTbKb1YGBlErm25oT9kDefzP9487uOb7Ql9XhP3M/lNgJ5ldMG+Bm3HujJqIF5x3geNcXJye1s3tpKUQGFP49IkB8VRnFRdD4SmV8yyEx8BYrCXAfugorFXD1sJgJMTBuaos5syS8mNOkd+pLFRQrqE1hS55A4Q00NoknTiGRgt2gE2wJR+25Zown+QvDIfjN7jYlt/ZZzWHZIBgi1ZaeqcAMKDsqdfoT3cwdZoHPbbYBIBhoSzsoY9yo3wob7aNFn638MRhx/QaGKS4B/ukY/oZp7ut2/aVe4cP4r24vhQA2fbkNj+J4+Y1m/1MwPzfka3rtsYK2k2AmDHZEwaOnpaCOQIKHgMKn/wpdMKFK8ZEHPzGahBpZGRV/82ggbNFTyoeW7riOgUI14dlkkZL4iBtOBHS1mixvOD02WcxILC1JQxH3CzkOepwCGfx2LXaZqcAddXskrtSZ4EH3ZnYAy0SHhattYIPoLuYYyCAj2ChDClfWzjmesqbfWwdUHA9WwMUkDKfw7XqwuoCOZfft9yN+twov7KfRNNuAsQK3rah48cIMAYcTbjguMyBYQQYBTDhXJVaGGGe0+7b05rBoxsAQXO0Rvd2FsoGB8DCFqdhFT50AklxEjZcrCVhoLDfouHsvLbFVQBbABrUd2wBW+EcdsaYEl2d2JvVcX4DIoTHtlkpd2yCsFxvfgFbw2YbPfAIIF0ASBIwoud7CRAKGRiw4BhoXtqxmT/GEILCjIOtlnoF0NAcLRWTFU2piGm7sKyMrJK2qnsIHYvDKn19qnXUjwpgC/YwgE1R7+2BAz2wGTvm97Cbi0F4jq2VgW22apfELYBUBCD2ZEqhYlD012M4WtIpgIZ08VjXDxWUMSacOU9vod6t3oHKaQA3iNhxozi4J0+O3DOMo9E1+k0KJCmALQEZ22JXrGkWAaQiAOGpwbpG2MfpaOlMAVogwIIFgPC6aScAodKGULcya1R5+Y2KbmGjcXSWQ13djwpgS9gh204XAaSCAMHhtPJk26nxVP1667oin90ACICPVloDQ5KWVHSgwUK5ArBGwEmKR+elQC8UEEAqAhCMw5yLWh/dryoAhBYJzjxtF1YcQEgpYAhbJmHqwy4rwEHZRiEUhte+FMhSAQGkQgDBQRlEsjSifriXAYS8pgVIEtitFRIHhmiXVVyYftBfeSymAgJIhQDCU6y6N3pT0WxQndjTAISyoaWRtNDS4AGAbRiOfZVpkmo6n7cCAkiFAJK3MVX5/lGAWKuh1TwDBhvLSLoGyFiXFTBhSer2SopD56VAlgoIIAJIlvZW2nsZQGxrADGH3yhjacYugA1rUrdXo/vpNymQlQICiACSla2V+j4GDtsaQOhistZCUgbTdEMRP/BoFnfSPXVeCmShgAAigGRhZ6W/h4HDtgYQHDxro3GKtK0IwMOqRQoUVQEBRAApqm0WKl0GDtsaQIAD8Ehy9IxrNBv7SMoo99AiBYqsgAAigBTZPguVNt6+CgFiXUwGk7jEAg8gokUKVFEBAUQAqaJd9yRPcQCh5dEIIHRvqSXRk+JQpAVQQAARQApghuVIAgCxDwqBAi0Q655KGudIOl+OHCuVUqCxAgKIANLYQvRrTYE4gPAaL0scKDoZ/6jdVDtSoMAKCCACSIHNs1hJY2p3JlhkTixrgdj4RlxXVSvfiBQrh0qNFGhPAQFEAGnPYvo4dBxA7PXdOIBoAL2PjaVPsi6ACCB9YuqdZzMOIDZALoB0rq9iKJ8CAogAUj6rzSnFcQCxpPA2lrVG7FwcVOw3baVAFRQQQASQKthxJnkAIFf+6hk38Sfr/RhICAwBJJMi0E0KpoAAIoAUzCSLmxwGz4EHa3SJA0jcm1nR63QsBcqsgAAigJTZfjNNeyOARAfMGRuhC0uLFKiyAgKIAFJl++5q3toBSKP5sbqaKEUmBXJUQAARQHI0v3LduhFAot986CPCcpWtUptOAQFEAElnOX14lQDSh4WuLDdUQAARQBoaiH7crwCD5waR/Wff2ou2QKJjItHwOpYCVVBAABFAqmDHmeQBgNirvNEbRrusBJCoQjquogICiABSRbvuSZ7aAYg+IuxJESjSgikggAggBTPJ4ianEUDCt67Y1yu8xS1Hpax7CgggAkj3rKniMbUKEHVfVdwQlL2aAgKIAFIzBu00VoBpTPifIGyjS9gC0RfoUXV0XFUFBBABpKq23fV8NQKIfXkeHUzveiIUoRQokAICSAsAWf3gardm1RrnYsLufXave/lPL9fW13e9HhuOa73YBSp8JaU9BQwg/FOp6GIA4XVeurC0SIF+UEAAiYFCCIrJX5vsxp8+3o0bO85NmjjpADiMGD7CTf36VDdt8jS/bnhiwwFhLD4BpNxVqhWAaPyj3GWs1LengADSACCrlq1yJ40+qQYE9jlnQGA7+OOD647D36L7Akh7xlm00I0AQloZ+4iblbdo+VB6pEC3FBBAGgDk5m/d7GZeOLMGiEtnXOpmXTurdmwAmXvTXHfR+RcldnMZSBDb1jlz5nSrDBVPRgrQdcUgelwXFkkAIPr+I6PC0G1yUwDfZX5MANkHkIXzF3oAAAFbOQc8rp55dQ0YV156ZR1Q3tj9hhs0aJBbcvcSt/7x9W7IJ4a4nRv39Y8nQMmLnVux68adKtAMIMBDb2B1qrKuL5MCAsg+Z//a8685BsPDlXMABGgYEC6/+PI6gNh52zJesuzeZbXwdt62AkiZqsaBaW0FIHRhaZEC/aKAAJLQWsDpL5i3wM04d0YNCBecd4HjnAFhx4Yd7pFfP1I7ZpB9xeIVtWMLZ1sBpNzVqhWA6A2scpexUt+eAgJIA4Bse3KbY5B885rNDlgMGzrMbV231e358x63ac0mx++c45jf6c7atWWXANKeDZYm9L/98SU/BsI2bqH1wWu8WqRAvygggDQACC2H5fctd6M+N8qv7HOOVsf0s6f7/UU/XOR4lXfkcSPdyiUrE+HBdWqBlLtatQIQPiTUIgX6RQEBpAlArPupG1sBpNzVqhlA+JhQixToJwUEEAGkn+y9o7w2A0hHketiKVBCBQQQAaSEZptPkgWQfHTXXYurgAAigBTXOguWMgPI1t2vFixlSo4UyEcBAUQAycfySnhXwMGX6AJICQtPSe6JAgKIANITw6pipAJIFUtVeepEAQFEAOnEfvrqWgGkr4pbmW1BAQFEAGnBTBQEBQQQ2YEUqFdAABFA6i1CR4kKCCCJ0uiHPlVAABFA+tT002Vbg+jpdNNV1VRAABFAqmnZPcoVANEiBaTAWwoIIAKI6kIbCgggbYiloJVXQAARQCpv5MqgFJACvVFAABFAemNZilUKSIHKKyCACCCVN3JlUApIgd4oIIAIIL2xLMUqBaRA5RUQQASQyhu5MigFpEBvFBBABJDeWJZilQJSoPIKCCACSOWNXBmUAlKgNwoIIAJIbyxLsUoBKVB5BQQQAaTyRq4MSgEp0BsFBBABpDeWpVilgBSovAICiABSeSNXBqWAFOiNAgKIANIby1KsUkAKVF4BAUQAqbyRK4NSQAr0RgEBRADpjWUpVikgBSqvgAAigFTeyJVBKSAFeqOAACKA9MayFKsUkAKVV0AAEUAKY+Rz5swpTFqKmhBp1LxkpFF2GgkgAkhza8sohDfGjO5V1ttIo+YlJ42y00gAEUCaW1tGIVTxmwstjaRRcwWah+iWHQkgGQJk/PjxDsG1SgPZgGygCjaAT3MZ+tB27jWgncAK66RXQQ1ZtinblA1kbwNyiHKIsgHZgGxANpDKBlJdJNJnT3ppLs1lA7KBotmAAKInD9mAbEA2IBtIZQOpLioaBZUePZnJBmQDsoHsbUAA0ZOHbEA2IBuQDaSygVQXifTZk16aS3PZgGygaDZQKYCsfnC1W7NqTWHfmc678Pc+u9e9/KeXa+vru16XVsGT55a1Ww7QQza132lH9ZE97deGuo0+6x9f31c2VBmATP7aZDf+9PFu3NhxbtLESQcUYt7Ouwj3HzF8hJv69alu2uRpft3wxAbp9DZA1j681k2ZNKVOD9nUfgcZp4/sab8+s2fNdieNPsmdOubUOjuqug1VAiCrlq3yhWdOmoLknB1r+5ahD/74YGkStDjMLhbOX+gmjp/oqOx2Tja13znG6YNOsqe3NHrt+dfcwIED3Z4/73FvvvSmGzRokFv36Drvg/BFZlNV9EuVAMjN37rZzbxwZq2gLp1xqZt17azasRVgv2+p8HNvmusuOv8idfVFQLJi8Yo6gMim9gOEehPVh3Oyp7c02rpuq7v+quu9v3lj9xvuiCOOcJvXbHb9YEOVAAjwuHrm1TVgXHnplXVA6XdwkH8MmyejJXcv8f20Qz4xxO3cuLOmWb9rFHWQsqnGAJE91etj9YcH1wlnTvD1qh9sqDIAARpWiJdffLkAEnnCNm1sS3fNsnuX1TSz8/26jQOIbGq/k4zqE7UT2ZMbQFffsZ851u3eursGkKrbUCUAsmDeAjfj3Bk1Z3jBeRc4zkWNvJ+Pd2zY4R759SM1TXjRAKfQz5qEeY86SNnUfnigU1Qf2VO9PkvvWeqOGnaU2/709lqd6gcbqgRAtj25zdEfS78jhj1s6DBHv2ToIPp9H43QhYE+NKI7a9eWXdLo7ZZa1EHKpuodZJw+sqe3NMLXUJ+inxD0gw1VAiDAYfl9y92oz43yK/v9Doy4/C/64SLHq5cjjxvpVi5ZKY2Cbj6+97jl27fUaSKb2g+ROH1kT2/pA1yBabhyrh/8UmUAEucwdW6/A5AW0kI2IBvotg0IIMFTaLfFVXyqsLIB2UCVbUAAEUBkA7IB2YBsIJUNpLqoykRV3vTEKBuQDcgGWrMBAURPHqWyAd54sWlqmAySwd1WKztvn9ngZqvXtBPuhT++4H6z8jex6enVJJa9iredfCtsa862ijqVynlUsQCUp/Yq39hTx7o7vn+Hd9K8BRSdALGRnryrz5xXjcLceuOt/iPUV3a84l8N5/XwuJUPxqLx8Nom3wJEz3PMa57Tz57u101rNsWGibuu2Tm+dibe44893j2w9IGuxdvsvvq9Pbutql4CiFogpbEBXqs97LDDaq9LMucQzj18fbKREwUgh3/kcD9XEdfaGk5rj3PHGfPRJXHz2+1zbvffzHDurv9zl58On3tGnQIT6TFhHh+Q/XLRL/18bDYFelz46PWdHAOSRnnvJG5dK1gk2UBpnEdSBnS+P4zbPhBlOnqcOuu5U8/1jtqO2eLEk2yilRYI1zK7KvEwb9hfn/ur+9iRH/Pbe+68pzbnGoCg+4hwp335NMfcYgYn9pkZAfDQrUWcAkh/2GmS7VX1vACiFkjhbYDpIYZ/ergbc9IY30VENxTr0Ucd7b74hS/6fY6/f/P3D4DHbx/4ba3riO4vrrGuJLbMX2SVGxicfOLJ7l/m/YvjnyUBHFoUNtPqz370M/8RJlPl0CUFsLiWJ3+m7+YY+JDW6P9aEUAEELOzKm0L7zyqJLbyks6J8BTP1NgMgPPPsExHAICTt+O47S/u+oUHD9dGV+YDY2r78DommBz9+dG+C4t/TmYTTtJF9POFP/fH3LPROAatE8DDjLUWdwgQBv5poZB+WivMJP3Qrx7ycKL7zAbiWw3HPdSFlc62rHy0TaefAKIWSGlsAAAwSN1OCwSAhP8oKnQUOO4oQPgdx09rJATOGaed4W687sbaufuX3F+DA9cw7oHz/+SQT/r/iMn4Ck7d7hcChLEU/gERrSNaOieMPMF3x9FdFr4Y0Go47iGApHOAVj7aptOvNM5DBZyugKukGw49TQuEbiv7N77hFocfBxCgw/9K4TdWrmHwnm4rO8c/LTNtgQf/A4JxGsDDpJ68zUX3Gm9zES4KkPDfLhO/DYADDQMe+62EI34BRPXD7DHLrQCyr/JlKbjulV5vAMKTe9xrtXYudNRozVP+DVff4B00Tjpc590yzzEwHpYJACCOpx57yp+nNcKrwnQ10fqx8ZDwmrMmnFUDQHieuOw4TFcICX5vBBCDSaNw/CaApLcrKyNt29dQzlMAKY0N4PAZK1j78Fr/tM8/7gEqVHzO8e96o06AsQbGLnijipYCLQK6mZ7b/JyfffecKefUXUM4WibEwyu4vGFlg+60TBiIZ6A9nLqbOHjjKnrv8FgAad85hfppv5j6lcZ5yICKaUBZlQuOnanoeaqn+4j/9EbrgJaBjSUwTT3jFJYm3oyi62n94+s9ROyjQ97moouJ13Bx7ICFa4ibAXRgQPy8lkvrhd+ACLDiTSv+bSm/2QA79yGe8aeP94P9DKJH/6VACBAGx3mTy9JJfh67/zF/HP4W7hM2KRy/qQXS3/XDbCnrrQCyr/JlLbru157mOHae/G3gmv/bYa/szv/efD/wjKa8vYQjNX2BiR3j1PmGhN/ohrLraZ3Yq7wAhQF6Wil0MzGWYXEZQOyYV4vtNV7OMRjOPS755iWOFsl1l19Xu5bfw/GTMF6LL+3WXgQAnjaOkjYuXdeeXUovN0DOc1/lliEUX4NwPKGM5UVrgpYSqw2sdyMfdN1ZvPy3yW7EqTiKXx+KUkb/Hzjx+fKI2nHnAAAAAElFTkSuQmCC" style="width: 400px; white-space: normal; font-style: normal; color: rgb(64, 64, 64); font-size: 14px;"></div></div></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment active'><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S5 lineNode"><span class = "S7"></span></div></div></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% 境界位置が7.9 mmにあるという情報を事前に与えた場合．
% "H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_focaldepth00079m_2layers.m"

%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%
% ch 50直下のピクセルにフォーカスをかける．
% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．
% F値を固定する．最近接距離をいくつに設定する？
% x-axis: 20 mmのときに全素子を使うという前提を設ける．
% 対象にする媒質データ：case26を用いる．
% IMCL割合を0 %に固定する．
% kgrid.x_vec が0となるのは251番目の要素．
% グリッド幅が0.1 mm
% 素子間ピッチが0.4 mm
% よって，最近接深度(最近接距離は0.4 mm)
% 深度ごとの細かい素子割当は，floor()を用いる．
% 整相加算の際に参照する音速を1580 m/sとする．
% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の
% 合計を評価関数として媒質の均質性を評価することも同時に行う．
% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear;
load("H:/data/kwave/config/t_pos_2board.mat");
load("H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat")
pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',1);
cd(pathname);
load('rfdata.mat');
load('kgrid.mat');
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");

% 初期設定
v_fat = 1450;%[m/s]
v_muscle = 1580;%[m/s]
rate_IMCL = linspace(1,20,20);
v_reference = zeros(1,length(rate_IMCL));
t_facing_distance = 0.04;%[m]
[~,num_receiver,num_transmitter] = size(rfdata);
num_echo_receiver = num_transmitter;
num_rate_IMCL = length(rate_IMCL);
num_medium  = num_rate_IMCL;
reference_point = zeros(1,num_echo_receiver);
reference_point_lowerlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
reference_point_upperlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
point_maxAmp_in_mask = zeros(1,num_echo_receiver);%マスク処理後のRFデータで振幅最大のサンプル点情報
distance_from_focal_point_all = zeros(1,num_echo_receiver);
% focal_signal_total = zeros(length(rate_IMCL),num_depth);
% focal_signal_total2 = zeros(length(rate_IMCL),num_depth);
focal_amp = zeros(1,num_echo_receiver);
% focal_phase = zeros(length(rate_IMCL),num_depth,num_echo_receiver);
homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);
homogeneity_total = zeros(num_rate_IMCL,num_medium);


num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．
focal_depth = zeros(1,num_depth);
focal_point = zeros(2,num_depth);
for ii = 1:num_depth
    focal_depth(1,ii) = (ii+3)*kgrid.dx;
    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);
    focal_point(1,ii) = 0;
end


for ll = 1:20
    pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',ll);
    cd(pathname);
    load('rfdata.mat');
    load('kgrid.mat');
    [num_sample,~,~] = size(rfdata);
    focused_rfdata = zeros(num_sample,num_echo_receiver);
    focused_rfdata_masked = zeros(num_sample,num_echo_receiver);
    focused_rfdata_amp = zeros(num_sample,num_echo_receiver);
    focused_rfdata_amp_masked = zeros(num_sample,num_echo_receiver);
    for kk = 1:num_rate_IMCL
        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);
        for ii = k
            target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
            distance_from_focal_point = zeros(1,length(target_element));
            %受信用の参照点算出
            for jj = 1:num_echo_receiver
                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+24);
                %25はfocal_amplitudeを最大にするオフセット．
                reference_point_lowerlimit(1,jj) ...
                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+24-1);
                reference_point_upperlimit(1,jj) ...
                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+24);
                %どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限
            end
            %送信ビームフォーミング（共通）
            for jj = 1:length(target_element)
                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
                % 遅延処理
                delay_time = delay_time_all(1,target_element(jj));%[sample]
                read_range_rfdata = length(delay_time+1:num_sample);
                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
            end
            hilb_rfdata = hilbert(focused_rfdata);
            focused_rfdata_amp = abs(hilb_rfdata);
            %         focused_rfdata_phase(:,:,ii) = atan(imag(hilb_rfdata)./real(hilb_rfdata));
            focused_rfdata_amp_masked = focused_rfdata_amp;
            focused_rfdata_masked = focused_rfdata;
            %RFデータマスキング（均質性評価のため）
            for jj = 1:num_echo_receiver
                focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
                focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
                focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
                focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
            end
            [~,point_maxAmp_in_mask] = max(focused_rfdata_amp_masked,[],1);
            for jj = 1:length(target_element)
                %受信ビームフォーミング（整相加算のため）
                %                 focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ ...
                %                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %                 focal_signal_total2(kk,ii) = focal_signal_total2(kk,ii)+ ...
                %                     focused_rfdata(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %                 focal_amp(kk,ii,target_element(jj)) = ...
                %                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %均質性評価指標
                homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));
            end
            homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);
        end
    end
end


%%

%% 参照インデックスを， 
%% 1. rfデータそのものの整相加算に用いて反射強度を計算，境界位置を推定． 
%% 2. rfデータに包絡線処理をしてその最大値と参照インデックスとの距離を測っている．
%%  2.が特に致命的なミス．包絡線処理をすることで，データのピークの位置が変わってしまう．この ミスは，どちらもrfデータorその絶対値を用いて議論することで対策できる．
% "H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_MT_ecxclude_envelopingProcess_2layers.m"
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%
% ch 50直下のピクセルにフォーカスをかける．
% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．
% F値を固定する．最近接距離をいくつに設定する？
% x-axis: 20 mmのときに全素子を使うという前提を設ける．
% 対象にする媒質データ：case26を用いる．
% IMCL割合を0 %に固定する．
% kgrid.x_vec が0となるのは251番目の要素．
% グリッド幅が0.1 mm
% 素子間ピッチが0.4 mm
% よって，最近接深度(最近接距離は0.4 mm)
% 深度ごとの細かい素子割当は，floor()を用いる．
% 整相加算の際に参照する音速を1580 m/sとする．
% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の
% 合計を評価関数として媒質の均質性を評価することも同時に行う．
% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear;
load("H:/data/kwave/config/t_pos_2board.mat");
load("H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat")
pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',1);
cd(pathname);
load('rfdata.mat');
load('kgrid.mat');
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");

% 初期設定
v_fat = 1450;%[m/s]
v_muscle = 1580;%[m/s]
rate_IMCL = linspace(1,20,20);
v_reference = zeros(1,length(rate_IMCL));
t_facing_distance = 0.04;%[m]
[~,num_receiver,num_transmitter] = size(rfdata);
num_echo_receiver = num_transmitter;
num_rate_IMCL = length(rate_IMCL);
num_medium  = num_rate_IMCL;
reference_point = zeros(1,num_echo_receiver);
reference_point_lowerlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
reference_point_upperlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
point_maxAmp_in_mask = zeros(1,num_echo_receiver);%マスク処理後のRFデータで振幅最大のサンプル点情報
distance_from_focal_point_all = zeros(1,num_echo_receiver);
% focal_signal_total = zeros(length(rate_IMCL),num_depth);
% focal_signal_total2 = zeros(length(rate_IMCL),num_depth);
focal_amp = zeros(1,num_echo_receiver);
% focal_phase = zeros(length(rate_IMCL),num_depth,num_echo_receiver);
homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);
homogeneity_total = zeros(num_rate_IMCL,num_medium);


num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．
focal_depth = zeros(1,num_depth);
focal_point = zeros(2,num_depth);
for ii = 1:num_depth
    focal_depth(1,ii) = (ii+3)*kgrid.dx;
    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);
    focal_point(1,ii) = 0;
end


for ll = 1:20
    pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',ll);
    cd(pathname);
    load('rfdata.mat');
    load('kgrid.mat');
    [num_sample,~,~] = size(rfdata);
    focused_rfdata = zeros(num_sample,num_echo_receiver);
    focused_rfdata_masked = zeros(num_sample,num_echo_receiver);
    focused_rfdata_amp = zeros(num_sample,num_echo_receiver);
    focused_rfdata_amp_masked = zeros(num_sample,num_echo_receiver);
    for kk = 1:num_rate_IMCL
        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);
        for ii = k
            target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
            distance_from_focal_point = zeros(1,length(target_element));
            %受信用の参照点算出
            for jj = 1:num_echo_receiver
                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);
                %25はfocal_amplitudeを最大にするオフセット．
                reference_point_lowerlimit(1,jj) ...
                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+1+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);
                reference_point_upperlimit(1,jj) ...
                    = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);
                %どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限
            end
            %送信ビームフォーミング（共通）
            for jj = 1:length(target_element)
                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
                % 遅延処理
                delay_time = delay_time_all(1,target_element(jj));%[sample]
                read_range_rfdata = length(delay_time+1:num_sample);
                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
            end
            hilb_rfdata = hilbert(focused_rfdata);
            focused_rfdata_amp = abs(hilb_rfdata);
            %         focused_rfdata_phase(:,:,ii) = atan(imag(hilb_rfdata)./real(hilb_rfdata));
            focused_rfdata_amp_masked = focused_rfdata_amp;
            focused_rfdata_masked = focused_rfdata;
            %RFデータマスキング（均質性評価のため）
            for jj = 1:num_echo_receiver
                focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
                focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
                focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
                focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
            end
            [~,point_maxAmp_in_mask] = max(focused_rfdata_masked,[],1);
            for jj = 1:length(target_element)
                %受信ビームフォーミング（整相加算のため）
                %                 focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ ...
                %                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %                 focal_signal_total2(kk,ii) = focal_signal_total2(kk,ii)+ ...
                %                     focused_rfdata(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %                 focal_amp(kk,ii,target_element(jj)) = ...
                %                     focused_rfdata_amp(reference_point(target_element(1,jj),ii,kk),target_element(1,jj),ii,kk)/length(target_element);
                %均質性評価指標
                homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));
            end
            homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);
        end
    end
end
%%
homogeneity = 1./homogeneity_total;
figure;
pcolor(homogeneity);
colorbar;
c = colorbar;
c.Label.String = 'homogeneity';
axis equal
axis tight
xlabel('correct IMCL percentage [%]');
ylabel('predicted IMCL percentage [%]')
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng','png',[400,350]);
%%
figure;
pcolor(homogeneity);
colorbar;
c = colorbar;
c.Label.String = '均質度評価指標';
axis equal
axis tight
xlabel('正解IMCL占有率 [%]');
ylabel('予測IMCL占有率[%]')
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/with_rf_signal_predeiction_vs_correct_IMCL_percentage_pcolor','png',[400,350]);
%% 
% 2018/11/09
% 
% 境界位置を反射強度から推定→波形形状評価
% 
% "H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_2layers_stroke.m"
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%
% 境界面を検出→参照点の妥当性評価
% ch 50直下のピクセルにフォーカスをかける．
% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．
% F値を固定する．最近接距離をいくつに設定する？
% x-axis: 20 mmのときに全素子を使うという前提を設ける．
% 対象にする媒質データ：case26を用いる．
% IMCL割合を0 %に固定する．
% kgrid.x_vec が0となるのは251番目の要素．
% グリッド幅が0.1 mm
% 素子間ピッチが0.4 mm
% よって，最近接深度(最近接距離は0.4 mm)
% 深度ごとの細かい素子割当は，floor()を用いる．
% 整相加算の際に参照する音速を1580 m/sとする．
% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の
% 合計を評価関数として媒質の均質性を評価することも同時に行う．
% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear;
load("H:/data/kwave/config/t_pos_2board.mat");
load("H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat")
pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',1);
cd(pathname);
load('rfdata.mat');
load('kgrid.mat');
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");

% 初期設定
v_fat = 1450;%[m/s]
v_muscle = 1580;%[m/s]
rate_IMCL = linspace(1,20,20);
v_reference = zeros(1,length(rate_IMCL));
t_facing_distance = 0.04;%[m]
[~,num_receiver,num_transmitter] = size(rfdata);
num_echo_receiver = num_transmitter;
num_rate_IMCL = length(rate_IMCL);
num_medium  = num_rate_IMCL;
reference_point = zeros(1,num_echo_receiver);
reference_point_lowerlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
reference_point_upperlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
point_maxAmp_in_mask = zeros(1,num_echo_receiver);%マスク処理後のRFデータで振幅最大のサンプル点情報
distance_from_focal_point_all = zeros(1,num_echo_receiver);

num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．
focal_depth = zeros(1,num_depth);
focal_point = zeros(2,num_depth);
for ii = 1:num_depth
    focal_depth(1,ii) = (ii+3)*kgrid.dx;
    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);
    focal_point(1,ii) = 0;
end


ind_max_signal = zeros(num_rate_IMCL,num_medium);
max_signal = zeros(num_rate_IMCL,num_medium);
homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);
homogeneity_total = zeros(num_rate_IMCL,num_medium);

for ll = 1:num_medium
    pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',ll);
    cd(pathname);
    load('rfdata.mat');
    load('kgrid.mat');
    [num_sample,~,~] = size(rfdata);
    focal_signal_total = zeros(num_rate_IMCL,num_depth);
    
    for kk = 1:num_rate_IMCL
        %% 反射強度プロファイルを求める．
        
        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);
        for ii = 1:num_depth
            focused_rfdata = zeros(num_sample,num_echo_receiver);
            target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
            distance_from_focal_point = zeros(1,length(target_element));
            %受信用の参照点算出
            for jj = 1:num_echo_receiver
                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);
            end
            %送信ビームフォーミング（共通）
            for jj = 1:length(target_element)
                
                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
                % 遅延処理
                delay_time = delay_time_all(1,target_element(jj));%[sample]
                read_range_rfdata = length(delay_time+1:num_sample);
                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
            end
            for jj = 1:length(target_element)
                %受信ビームフォーミング（整相加算のため）
                focal_signal_total(kk,ii) = focal_signal_total(kk,ii)+ ...
                    focused_rfdata(reference_point(1,target_element(1,jj)),target_element(1,jj))/length(target_element);
            end
        end
        %% 反射強度が最大の焦点位置を探索．
        [max_tmp,ind_tmp] = findpeaks(abs(focal_signal_total(kk,:)),'Npeaks',1,'SortStr','descend');
        ind_max_signal(kk,ll) = ind_tmp;
        max_signal(kk,ll) = max_tmp;
        ii = ind_tmp;
        %% 参照点と波面との誤差を評価．
        focused_rfdata = zeros(num_sample,num_echo_receiver);
        %         focused_rfdata_masked = zeros(num_sample,num_echo_receiver);
        target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
        distance_from_focal_point = zeros(1,length(target_element));
        %受信用の参照点算出
        for jj = 1:num_echo_receiver
            distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
            delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
            reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);
            %25はfocal_amplitudeを最大にするオフセット．
            reference_point_lowerlimit(1,jj) ...
                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);
            reference_point_upperlimit(1,jj) ...
                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);
            %どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限
        end
        %送信ビームフォーミング（共通）
        for jj = 1:length(target_element)
            distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
            % 遅延処理
            delay_time = delay_time_all(1,target_element(jj));%[sample]
            read_range_rfdata = length(delay_time+1:num_sample);
            focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
        end
        %         hilb_rfdata = hilbert(focused_rfdata);
        %         focused_rfdata_amp = abs(hilb_rfdata);
        %         focused_rfdata_amp_masked = focused_rfdata_amp;
        focused_rfdata_masked = focused_rfdata;
        %RFデータマスキング（均質性評価のため）
        for jj = 1:num_echo_receiver
            %             focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
            %             focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
            focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
            focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
        end
        [~,point_maxAmp_in_mask] = max(focused_rfdata_masked,[],1);
        for jj = 1:length(target_element)
            %均質性評価指標
            homogeneity_percel(kk,jj) = abs(point_maxAmp_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));
        end
        homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);
    end
end
%%
load("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_20x20.mat")
homogeneity = 1./homogeneity_total;
figure;
pcolor(homogeneity);
colorbar;
c = colorbar;
c.Label.String = 'homogeneity';
axis equal
axis tight
xlabel('correct IMCL percentage [%]');
ylabel('predicted IMCL percentage [%]')
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng','png',[400,350]);
%%
homogeneity = 1./homogeneity_total;
figure;
pcolor(homogeneity);
colorbar;
c = colorbar;
c.Label.String = '均質度評価指標';
axis equal
axis tight
xlabel('正解IMCL占有率 [%]');
ylabel('予測IMCL占有率 [%]')
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor','png',[400,350]);
%%
figure;
tmp = zeros(20,20);
for ii = 1:20
    tmp(ii,:) = focal_depth(1,ind_max_signal(ii,:))*1e3;
end
pcolor(tmp);
c = colorbar;
c.Label.String = '媒質境界深度[mm]';
axis equal
axis tight
xlabel('正解IMCL占有率 [%]');
ylabel('予測IMCL占有率 [%]');
axis equal
axis tight
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_detection_depth_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor','png',[400,350]);
%%
figure;
tmp = zeros(20,20);
for ii = 1:20
    tmp(ii,:) = focal_depth(1,ind_max_signal(ii,:))*1e3;
end
pcolor(tmp);
c = colorbar;
c.Label.String = 'boundary depth[mm]';
axis equal
axis tight
xlabel('correct IMCL percentage [%]');
ylabel('predicted IMCL percentage [%]');
axis equal
axis tight
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_detection_depth_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng','png',[400,350]);
%%
figure;
pcolor(max_signal);
c = colorbar;
c.Label.String = '信号強度[au]';
axis equal
axis tight
xlabel('正解IMCL占有率 [%]');
ylabel('予測IMCL占有率 [%]');
axis equal
axis tight
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_max_intensity_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor','png',[400,350]);
%%
figure;
pcolor(max_signal);
c = colorbar;
c.Label.String = 'Intensity[au]';
axis equal
axis tight
xlabel('correct IMCL percentage [%]');
ylabel('predicted IMCL percentage [%]');
axis equal
axis tight
exportfig('H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_max_intensity_with_errors_boundary_position_detection_with_rfsignal_predeiction_vs_correct_IMCL_percentage_pcolor_eng','png',[400,350]);
%% 反射強度による境界位置検出におけるエラーの調査
% |正解IMCL占有率: 10 %, 予測IMCL占有率: 16 %において誤検出が見られた．このときと，検出が正しく機能した，正解IMCL占有率： 
% 10 %, 予測IMCL占有率: 10 %での結果(focal_signal_total[dim={20,20}])を比較して，上述したピーク関数を用いる推定方法の問題点を明らかにする．|
% 
% |"H:/experiments/2018_11_07_IMCL_estimation_principle_verifiacation/ex2018_11_08_path_only_including_MT_2layers_stroke2.m"|
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%％％％％％％％%%%%%
% 境界面を検出→参照点の妥当性評価
% ch 50直下のピクセルにフォーカスをかける．
% フォーカス深度を１グリッドずつ変化させて，開口合成受信データを生成する．
% F値を固定する．最近接距離をいくつに設定する？
% x-axis: 20 mmのときに全素子を使うという前提を設ける．
% 対象にする媒質データ：case26を用いる．
% IMCL割合を0 %に固定する．
% kgrid.x_vec が0となるのは251番目の要素．
% グリッド幅が0.1 mm
% 素子間ピッチが0.4 mm
% よって，最近接深度(最近接距離は0.4 mm)
% 深度ごとの細かい素子割当は，floor()を用いる．
% 整相加算の際に参照する音速を1580 m/sとする．
% 整相加算の前に参照点と受信chごとの振幅(ヒルベルト変換後絶対値)最大値との距離の
% 合計を評価関数として媒質の均質性を評価することも同時に行う．
% update:rf-dataの配列サイズが大きくなってきたので，変数区分を細分化して各変数の呼び出し速度を上げる．[2018/11/05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear;
load("H:/data/kwave/config/t_pos_2board.mat");
load("H:/data/kwave/medium/2018_11_07_layer_medium/reference.mat")
pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',1);
cd(pathname);
load('rfdata.mat');
load('kgrid.mat');
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/rfdata.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/medium.mat");
% load("H:/data/kwave/result/2018_10_21_point_medium/point_mudium5MHz/kgrid.mat");

% 初期設定
v_fat = 1450;%[m/s]
v_muscle = 1580;%[m/s]
rate_IMCL = linspace(1,20,20);
v_reference = zeros(1,length(rate_IMCL));
t_facing_distance = 0.04;%[m]
[~,num_receiver,num_transmitter] = size(rfdata);
num_echo_receiver = num_transmitter;
num_rate_IMCL = length(rate_IMCL);
num_medium  = num_rate_IMCL;
reference_point = zeros(1,num_echo_receiver);
reference_point_lowerlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
reference_point_upperlimit = zeros(1,num_echo_receiver);%均質性評価のためのRFデータマスキングに使う
point_max_in_mask = zeros(1,num_echo_receiver);%マスク処理後のRFデータで振幅最大のサンプル点情報
distance_from_focal_point_all = zeros(1,num_echo_receiver);

num_depth = (t_pos(2,1)-t_pos(2,101))/kgrid.dx - 3;%'3'とあるのは，最近接距離が0.4 mmであることを考慮している．
focal_depth = zeros(1,num_depth);
focal_point = zeros(2,num_depth);
for ii = 1:num_depth
    focal_depth(1,ii) = (ii+3)*kgrid.dx;
    focal_point(2,ii) = t_pos(2,1)-focal_depth(1,ii);
    focal_point(1,ii) = 0;
end


ind_max_signal = zeros(num_rate_IMCL,num_medium);
max_signal = zeros(num_rate_IMCL,num_medium);
homogeneity_percel = zeros(num_rate_IMCL,num_echo_receiver);
homogeneity_total = zeros(num_rate_IMCL,num_medium);
focal_signal_total = zeros(num_depth,num_rate_IMCL,num_medium);
for ll = 10
    pathname = sprintf('H:/data/kwave/result/2018_11_07_layer_medium/Layer_medium_boundary_7.9mm_ IMCL%d%%',ll);
    cd(pathname);
    load('rfdata.mat');
    load('kgrid.mat');
    [num_sample,~,~] = size(rfdata);

    
    for kk = 10:6:16
        %% 反射強度プロファイルを求める．
        v_reference(1,kk) = v_muscle*(1-rate_IMCL(1,kk)/100) + v_fat*(rate_IMCL(1,kk)/100);
        for ii = 1:num_depth
            focused_rfdata = zeros(num_sample,num_echo_receiver);
            target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
            distance_from_focal_point = zeros(1,length(target_element));
            %受信用の参照点算出
            for jj = 1:num_echo_receiver
                distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
                delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
                reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);
            end
            %送信ビームフォーミング（共通）
            for jj = 1:length(target_element)
                
                distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
                % 遅延処理
                delay_time = delay_time_all(1,target_element(jj));%[sample]
                read_range_rfdata = length(delay_time+1:num_sample);
                focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                    +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
            end
            for jj = 1:length(target_element)
                %受信ビームフォーミング（整相加算のため）
                focal_signal_total(ii,kk,ll) = focal_signal_total(ii,kk,ll)+ ...
                    focused_rfdata(reference_point(1,target_element(1,jj)),target_element(1,jj))/length(target_element);
            end
        end
        %% 反射強度が最大の焦点位置を探索．
        [max_tmp,ind_tmp] = findpeaks(abs(focal_signal_total(:,kk,ll)),'Npeaks',1,'SortStr','descend');
        ind_max_signal(kk,ll) = ind_tmp;
        max_signal(kk,ll) = max_tmp;
        ii = ind_tmp;
        %% 参照点と波面との誤差を評価．
        focused_rfdata = zeros(num_sample,num_echo_receiver);
%         focused_rfdata_masked = zeros(num_sample,num_echo_receiver);
        target_element = find((-focal_depth(1,ii)/2<=t_pos(1,1:100)&(t_pos(1,1:100)<=focal_depth(1,ii)/2)));
        distance_from_focal_point = zeros(1,length(target_element));
        %受信用の参照点算出
        for jj = 1:num_echo_receiver
            distance_from_focal_point_all(1,jj) = norm(t_pos(:,jj) - focal_point(:,ii));
            delay_time_all = round(((distance_from_focal_point_all - focal_depth(1,ii))/v_reference(1,kk))/kgrid.dt);%[sample]
            reference_point(1,jj) = round(delay_time_all(1,jj)+(2*focal_depth(1,ii)/v_reference(1,kk))/kgrid.dt+25-1);
            %25はfocal_amplitudeを最大にするオフセット．
            reference_point_lowerlimit(1,jj) ...
                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_muscle)+(2*focal_depth(1,ii)/v_muscle)/kgrid.dt+25-1-1);
            reference_point_upperlimit(1,jj) ...
                = round(delay_time_all(1,jj)*(v_reference(1,kk)/v_fat)+(2*focal_depth(1,ii)/v_fat)/kgrid.dt+25-1);
            %どんなに遅延しても早く到達してもこの範囲内に焦点位置からのエコーパルスが入っているであろう上限・下限
        end
        %送信ビームフォーミング（共通）
        for jj = 1:length(target_element)
            distance_from_focal_point(1,jj) = distance_from_focal_point_all(1,target_element(jj));
            % 遅延処理
            delay_time = delay_time_all(1,target_element(jj));%[sample]
            read_range_rfdata = length(delay_time+1:num_sample);
            focused_rfdata(1:read_range_rfdata,:) = focused_rfdata(1:read_range_rfdata,:)...
                +  rfdata(delay_time+1:num_sample,1:100,target_element(jj));%整相加算
        end
        focused_rfdata_masked = focused_rfdata;
        %RFデータマスキング（均質性評価のため）
        for jj = 1:num_echo_receiver
%             focused_rfdata_amp_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
%             focused_rfdata_amp_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
            focused_rfdata_masked(1:reference_point_lowerlimit(1,jj),jj) = 0;
            focused_rfdata_masked(reference_point_upperlimit(1,jj):end,jj) = 0;
        end
        [~,point_max_in_mask] = max(focused_rfdata_masked,[],1);
        for jj = 1:length(target_element)
            %均質性評価指標
            homogeneity_percel(kk,jj) = abs(point_max_in_mask(1,target_element(jj)) - reference_point(1,target_element(jj)));
        end
        homogeneity_total(kk,ll) = sum(homogeneity_percel(kk,:))/length(target_element);
    end
end
%%
load("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat")
figure;
plot(focal_depth*1e3,focal_signal_total(:,16,10));
hold on
plot(focal_depth*1e3,focal_signal_total(:,10,10));
title('正解IMCL占有率 = 10 %')
xlabel('焦点深さ[mm]')
ylabel('信号強度[au]')
legend('予測IMCL占有率 = 16 %','予測IMCL占有率 = 10 %')
exportfig("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF",'png',[400,300]);
%%
load("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat")
figure;
plot(focal_depth*1e3,focal_signal_total(:,16,10));
hold on
plot(focal_depth*1e3,focal_signal_total(:,10,10));
title('正解IMCL占有率 = 10 %')
xlabel('焦点深さ[mm]')
ylabel('信号強度[au]')
legend('予測IMCL占有率 = 16 %','予測IMCL占有率 = 10 %')
xlim([6.4 12.3])
ylim([-0.82 1.68])
exportfig("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF_detail",'png',[400,300]);
%%
load("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_with_rfsignal_homogeneity_SingleLayer_boundary_7.9mm_varied_focaldepth_error_check.mat")
figure;
plot(focal_depth*1e3,focal_signal_total(:,16,10));
hold on
plot(focal_depth*1e3,focal_signal_total(:,10,10));
title('正解IMCL占有率 = 10 %')
xlabel('焦点深さ[mm]')
ylabel('信号強度[au]')
legend('予測IMCL占有率 = 16 %','予測IMCL占有率 = 10 %')
xlim([0.0 21.3])
ylim([-0.95 2.00])
exportfig("H:/result/2018_11_07_IMCL_estimation_principle_verifiacation/2018_11_09_focased_signal_comparison_TorF_detail2",'png',[400,300]);
%%
##### SOURCE END #####
--></body></html>